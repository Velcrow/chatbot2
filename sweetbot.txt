if (sweetbot) sweetbot.shutdown();
var sweetbot = {
    lotWinner: null,
    settings: {
        a: {
            autoJoin: true,
            autoWoot: true,
            bouncerLock: false,
            lottery: true,
            customMotd: false,
            motd: "Ative uma mensagem  adicional usando !motd [mensagem]!",
            motdInt: 5,
            afkRemoval: true,
            forceWoot: true,
            afkLimit: 120,
            userCmdCD: 20,
            userCmds: true,
            gettingMehs: false,
            mehlimit: 10,
            duelDelay: 120,
            ruleSkip: true,
            chatFilter: true,
            historyGuard: true
        },
        b: {
            lockDown: false,
            spamAtt: false,
            apoc: false,
            timeGuard: true,
            cycleGuard: false,
            lockGuard: false,
            autoSkip: false,
            video: true,
            removedFilter: false
        }
    },
    version: "6.6.6",
    stats: {
        launchTime: Date.now(),
        woots: 0,
        mehs: 0,
        grabs: 0,
        afk: 0,
        lot: 0,
        songCounter: 0,
        lengths: [3],
    },
    vars: {
        motdInd: 0,
        lockedTime: 0,
        cycleTime: 0,
        skipping: false,
        globCounter: 0,
        lockSkipping: false,
        cycleWasFalse: null,
        lockskipPos: 3,
        lotWinner: null,
        lotWinners: [],
        userCmdOnCD: false,
        cmdOnCD: false,
        nextDJ: API.getWaitList()[0],
        lastChat: Date.now(),
        duel: [],
        duelReady: true,
        muteVotes: 0,
        muteVoters: [],
        voteMute: false,
        voteMuter: null,
        execute: [],
        autoReply: 'off',
        capsLimit: 50,
        tacos: ["crispy taco","mexican taco","vegetarian taco","spicy taco","meatlover taco","cheese taco","wet hamburger","taco shell","delicious taco","gross taco","horse meat taco","kinky taco","burrito","donger ÃƒÂ£Ã†â€™Ã‚Â½Ãƒ Ã‚Â¼Ã‚Â¼Ãƒ Ã‚ÂºÃ‹â€ Ãƒâ„¢Ã¢â‚¬Å¾ÃƒÂÃ…â€œÃƒ Ã‚ÂºÃ‹â€ Ãƒ Ã‚Â¼Ã‚Â½ÃƒÂ¯Ã‚Â¾Ã¢â‚¬Â°"]
    },
    timeouts: {
        spamAlert: undefined,
        bouncerLock: undefined,
        globCounter: undefined,
        skip: undefined,
        lotSelect: undefined,
        userCmds: undefined,
        autoSkip: undefined,
        cmdCD: undefined,
        dcCheck: undefined
    },
    timeoutCalls: {
        spamAlert: function () {
            if (sweetbot.settings.b.spamAtt) sweetbot.timeouts.spamAlert = setInterval(function () {
                sweetbot.sendMsg(" PROTEÇÃO DE SPAM ATIVA! EVITE ESTAR ATIVO NO CHAT PARA EVITAR SER BANIDO!.")
            }, 3e4);
            else clearInterval(sweetbot.timeouts.spamAlert)
        },
        globCounter: function () {
            sweetbot.timeouts.globCounter = setInterval(function () {
                sweetbot.vars.globCounter++;
                if (!(sweetbot.vars.globCounter % 60) && sweetbot.settings.a.lottery && Date.now() - sweetbot.stats.launchTime >= 1e3 * 60 * 20) sweetbot.boostLottery()
            }, 6e4)
        },
        dcCheck: function () {
            sweetbot.timeouts.dcCheck = setInterval(function () {
                if (Date.now() - sweetbot.vars.lastChat >= 1e3 * 60 * 10) sweetbot.shutdown()
            }, 6e4)
        }
    },
    ctx: {
        room : null,
        wl : null
    },
    userData: {},
    waitList: [],
    addToWL: [],
    bouncerPlus: ["lock", "cycle", "move", "bouncer+"],
    userCmds: ["dc", "theme","blacklist","help", "rules", "emoji", "commands", "eta", "site", "ping", "oki", "song", "link"],
    sock: undefined,
    onchat: function(a) { 
        sweetbot.eventChat({ message: stripLink(a.message), un: a.un, uid: a.uid, timestamp: a.timestamp, cid: a.cid, type: a.type }) 
    },
    startup: function () {
        this.proxy = {
            eventJoin: $.proxy(this.eventJoin, this),
            eventLeave: $.proxy(this.eventLeave, this),
            eventDjAdv: $.proxy(this.eventDjAdv, this),
            eventCommand: $.proxy(this.eventCommand, this),
            eventDjUpdate: $.proxy(this.eventDjUpdate, this),
            eventVoteUpdate: $.proxy(this.eventVoteUpdate, this),
            eventWaitlistUpdate: $.proxy(this.eventWaitlistUpdate, this)
        };
        API.sendChat('Run to the hills!');
        setTimeout(function(){API.sendChat("Sweet Chat Bot Ativado! Corram para as colinas seus lindos! Version " + sweetbot.version);}, 100);
        console.log("Sweet Chat Bot Está ativo! Version " + sweetbot.version);
        API.moderateDeleteChat = function (cid) {
            $.ajax({
                url: "https://stg.plug.dj/_/chat/" + cid,
                type: "DELETE"
            })
        };
        this.getModules();
 
        API.getRoomInfo = function(type) {
            switch (type.toLowerCase()) {
                case 'title':
                    return sweetbot.ctx.room.attributes.name;                   
                case 'welcome':
                    return sweetbot.ctx.room.attributes.welcome;                   
                case 'description':
                    return sweetbot.ctx.room.attributes.description;
                case 'host':
                    return sweetbot.ctx.room.attributes.hostName;
                case 'locked':
                    return sweetbot.ctx.wl.attributes.isLocked;
                case 'cycle':
                    return sweetbot.ctx.wl.attributes.shouldCycle;
                default:
                    return console.error('Invalid Room Info Type Specified!');
            }
        };
        API.on(API.CHAT, this.onchat, this);
        API.on(API.USER_JOIN, this.proxy.eventJoin);
        API.on(API.ADVANCE, this.proxy.eventDjUpdate);
        API.on(API.ADVANCE, this.proxy.eventDjAdv);
        API.on(API.USER_LEAVE, this.proxy.eventLeave);
        API.on(API.VOTE_UPDATE, this.proxy.eventVoteUpdate);
        API.on(API.CHAT_COMMAND, this.proxy.eventCommand);
        API.on(API.WAIT_LIST_UPDATE, this.proxy.eventWaitlistUpdate);
        this.vars.globCounter = (new Date).getMinutes();
        var e = JSON.parse(localStorage.getItem("sweetbotData")),
         t = JSON.parse(localStorage.getItem("sweetbotSettings")),
         n = API.getUsers(),
         r, i;
        if (e && Date.now() - e.b < 1e3 * 60 * 10) {
            this.stats = e.stats;
            this.userData = e.users;
            this.arrays = e.arrays;
        } else localStorage.removeItem("sweetbotData");
        if (t) this.settings.a = t.settings;
        else localStorage.removeItem("sweetbotSettings");
        for (r in this.userData) {
            var s = false;
            for (i in n) {
                if (r == n[i].id) {
                    s = true;
                    break
                }
            }
            this.userData[r].inRoom = s
        }
        this.timeoutCalls.globCounter();
        for (r in n) if (!this.userData[n[r].id]) this.newUser(n[r].id);
        this.refreshWL();
        if (this.getLocked()) this.vars.lockedTime = Date.now();
        if (this.getCycle()) this.vars.cycleTime = Date.now();
        API.djJoin();
    },
    historyCheck: function(data) {
        var history = API.getHistory(); var caught = -1;
        for (var i in history) {
            if (history[i].media.cid === API.getMedia().cid) {var caught = i; return caught;}
        }
        console.log('history check')
    },
    cleanString: function(string) {
        return string.replace(/&#39;/g, "'").replace(/&amp;/g, "&").replace(/&#34;/g, "\"").replace(/&#59;/g, ";").replace(/&lt;/g, "<").replace(/&gt;/g, ">");
    },
    shutdown: function () {
        API.off(API.CHAT, this.onchat);
        API.off(API.USER_JOIN, this.proxy.eventJoin);
        API.off(API.ADVANCE, this.proxy.eventDjAdv);
        API.off(API.USER_LEAVE, this.proxy.eventLeave);
        API.off(API.VOTE_UPDATE, this.proxy.eventVoteUpdate);
        API.off(API.CHAT_COMMAND, this.proxy.eventCommand);
        API.off(API.ADVANCE, this.proxy.eventDjUpdate);
        API.off(API.WAIT_LIST_UPDATE, this.proxy.eventWaitlistUpdate);
        for (var e in this.timeouts) {
            clearTimeout(this.timeouts[e]);
            clearInterval(this.timeouts[e])
        }
        console.log("Sweet Chat Bot" + this.version + " shut down.");
        sweetbot = false
    },
    eventChat: function (e) {
        if (!e.uid) return;
        if (this.settings.b.apoc) API.moderateDeleteChat(e.cid);
        else if (this.settings.b.lockDown && API.getUser(e.uid).role === 0 && API.getUser(e.uid).gRole === 0) API.moderateDeleteChat(e.cid);
        else if (this.userData[e.uid].muted) API.moderateDeleteChat(e.cid);
        e.message = this.stringFix(e.message);
        if (e.uid != API.getUser().id) this.vars.lastChat = Date.now();
        if (!this.userData[e.uid]) this.newUser(e.uid);
        this.userData[e.uid].chatted = true;
        if (e.message.indexOf('[AR]') === -1 && e.message.indexOf('[AFK]') === -1) this.userData[e.uid].afk.time = Date.now();
        this.userData[e.uid].afk.warn1 = 0, this.userData[e.uid].afk.warn2 = false;
        if (sweetbot.settings.a.chatFilter) this.messageDeletion(e, e.cid, API.getUser(e.uid).role);
        for (var i in this.arrays.spam) {
            if (e.message.toLowerCase().indexOf(this.arrays.spam[i]) > -1 && API.getUser(e.uid).role === 0 && sweetbot.settings.a.chatFilter) API.moderateDeleteChat(e.cid);
        }
        if (!e.message.indexOf("!")) this.commandHandler(e);
        if (this.userData[e.uid].inbox.msg.length) {
            API.sendChat("@" + e.un + " [Msg from " + this.userData[e.uid].inbox.un + "] " + this.userData[e.uid].inbox.msg);
            this.userData[e.uid].inbox.msg = "";
            this.userData[e.uid].inbox.un = ""
        }
        this.shortenURL(e);
        if (sweetbot.vars.execute.indexOf(e.uid) > -1) API.sendChat('@' + e.un + ' E morreu...'), API.moderateBanUser(e.uid, 0, -1), delete sweetbot.vars.execute[sweetbot.vars.execute.indexOf(e.uid)];
        if (e.type === 'mention' && sweetbot.vars.autoReply !== 'off') API.sendChat('[AR] @' + e.un + ' ' + sweetbot.vars.autoReply);
        if(e.message.indexOf('!afkmessage') === -1) sweetbot.userData[e.uid].afkMessage = '';
        if(e.message.match(/@\S+/g) !== null) {
            var unn = [];
            for (var i in e.message.match(/@\S+/g)) {
                unn.push(e.message.match(/@\S+/g)[i].substr(1));
            }
  
        }
        if (unn) {
            for (var i in unn) {
                if (sweetbot.userData[sweetbot.getUserByName(unn[i])].afkMessage !== '' && sweetbot.userData[sweetbot.getUserByName(unn[i])].afkCooldown) {
                    API.sendChat('[' + unn[i] + ' AFK Msg] @' + e.un + ' ' + sweetbot.userData[sweetbot.getUserByName(unn[i])].afkMessage);
                    sweetbot.userData[sweetbot.getUserByName(unn[i])].afkCooldown = false;
                }
            }
        }
         
        var b = e.message.match(/[A-Z]/g);
        if (e.message.length > 100 && b && b.length > 40) {
            API.moderateDeleteChat(e.cid);
            setTimeout(function(e){
                API.moderateMuteUser(e.uid, 0, API.MUTE.LONG);
            }, 2000, e);
        }       
    },
    eventCommand: function (e) {
        switch (e.split(' ')[0]) {
        case "/autojoin":
            this.settings.a.autoJoin = !this.settings.a.autoJoin;
            API.chatLog(this.settings.a.autoJoin ? "Autojoin enabled" : "Autojoin disabled", true);
            break;
        case "/autowoot":
            this.settings.a.autoWoot = !this.settings.a.autoWoot;
            API.chatLog(this.settings.a.autoWoot ? "Autowoot enabled" : "Autowoot disabled", true);
            break;
        case "/lock":
            API.moderateLockWaitList(true);
            break;
        case "/unlock":
            API.moderateLockWaitList(false);
            break;
        case "/getmehs":
            this.getMehs();
            if (e.split(' ')[1] === 'enable') {
                this.settings.a.gettingMehs = true;
                API.chatLog('Getmehs enabled', true);
            } else if (e.split(' ')[1] === 'disable') {
                this.settings.a.gettingMehs = false;
                API.chatLog('Getmehs disabled', true);
            }
            break;
        case "/video":
            this.settings.b.video = !this.settings.b.video;
            $("#yt-frame").slideToggle();
            $(".background").slideToggle();
            API.chatLog("Toggled video", true);
            break;
        case '/fixmotd':
            var a = JSON.parse(localStorage.getItem('sweetbotData'));
            delete a.arrays.motd;
            localStorage.setItem('sweetbotData', JSON.stringify(a));
            break;
        case '/autoreply':
            sweetbot.vars.autoReply = e.substr(11);
            API.chatLog('AutoReply is now "' + e.substr(11) + '"', true);
            break;
        }
    },
    ytc : {
    now : null,
    check: function(e){
        sweetbot.ytc.now=null;
        if (!e)
            return API.sendChat('Nao foi possivel obter informações do vídeo');
          
        if (typeof e == 'string')
            e = JSON.parse(e);
          
        if ( e.error)
            return API.sendChat('Erro ao obter informações do vídeo.');
        if (e.items && !e.items.length){
            API.sendChat('@'+API.getDJ().username+' vídeo privado ou indisponivel, você será pulado e movido para primeiro na lista!');
            return sweetbot.lockSkip();
        }
    },
    nDJ : function(e){
        if (!sweetbot.settings.b.removedFilter || !e.media || e.media.format != 1){
            this.now = null;
            return;
        }
          
        $.get('https://www.googleapis.com/youtube/v3/videos?id='+e.media.cid+'&part=snippet,contentDetails,statistics,status&key=AIzaSyDg9pSV0Tkbq8fo7I1z_gz4oVN0IZ3TeHw',
            sweetbot.ytc.check)
        .error(function(data){
            sweetbot.ytc.check(data.responseJSON);
        });
    }
},
    eventDjAdv: function (e) {
        if(sweetbot.settings.a.ruleSkip && sweetbot.arrays.ruleSkip[API.getMedia().cid] !== undefined){
            switch(sweetbot.arrays.ruleSkip[e.media.cid].rule){
                case '1':
                    API.sendChat('@'+e.dj.username+' Unavailable Video');
                    API.moderateForceSkip();
                    break;
                case '2':
                    API.sendChat('@'+e.dj.username+' Overplayed Song');
                    API.moderateForceSkip();
                    break;
                case '3':
                    API.sendChat('@'+e.dj.username+' NSFW Video');
                    API.moderateForceSkip();
                    break;
                case '4':
                    API.sendChat('@'+e.dj.username+' Wrong Genre');
                    API.moderateForceSkip();
                    break;
                case '5':
                    API.sendChat('@'+e.dj.username+' Too Long');
                    API.moderateForceSkip();
                    break;
                case '34':
                    API.sendChat('@' + e.dj.username + ' hehehehhehehehehhe');
                    API.moderateForceSkip();
                case '99':
                    API.sendChat('@'+e.dj.username+' Just no..');
                    API.moderateForceSkip();
                    break;
                default:
                    API.sendChat('@'+e.dj.username+' '+sweetbot.arrays.ruleSkip[e.media.cid].rule);
                    API.moderateForceSkip();
                    break;
            }
        }
        $("#woot").mousedown();
        sweetbot.ytc.nDJ(e);
        sweetbot.stats.lengths.push(API.getMedia().duration / 60);
        if (!this.settings.b.video) $("#yt-frame").hide();
        for (var t in this.userData) this.userData[t].vote = 0;
        if (this.settings.a.autoJoin && API.getWaitListPosition() == -1 && !this.getLocked()) API.djJoin();
        if (this.addToWL.length) this.addUsers();
        if (!this.userData[e.dj.id]) this.newUser(e.dj.id);
        this.resetDC(e.dj.id);
  
/*        if (this.vars.nextDJ.id != e.dj.id && this.vars.nextDJ.id != API.getWaitList()[0].id) {
            this.sendMsg(this.vars.nextDJ.username + " Estava suposto a ser o DJ! Alguma coisa ruim aconteceu!");
            document.getElementById("chat-sound").playChatSound();
            setTimeout(function () {
                document.getElementById("chat-sound").playChatSound()
            }, 300);
            setTimeout(function () {
                document.getElementById("chat-sound").playChatSound()
            }, 500)
        }*/
        this.vars.nextDJ = API.getWaitList()[0];
        console.log(e)
        if (!this.vars.skipping) {
            this.stats.woots += e.lastPlay.score.positive;
            this.stats.mehs += e.lastPlay.score.negative;
            this.stats.grabs += e.lastPlay.score.grabs;
            ++this.stats.songCounter;
            if (API.getDJ().id == 666 || API.getDJ().id == 666) API.sendChat("Look " + API.getDJ().username + " is now playing " + API.getMedia().author + ' - ' + API.getMedia().title + "! Olhe! " + API.getDJ().username + ' está tocando ' + API.getMedia().author + ' - ' + API.getMedia().title);
            else if (!(this.stats.songCounter % this.settings.a.motdInt)) this.motdFunction()
        }
        /*if (this.getCycle()) setTimeout(function () {
            API.moderateMoveDJ(e.lastPlay.dj.attributes.id, sweetbot.vars.lockskipPos)
        }, 4e3);*/
        var skipOnExceed;
        if (e.media.duration > 420 && sweetbot.settings.b.timeGuard){
                API.sendChat("@"+API.getDJ().username+" This song exceeds the max length! Essa música excede o tempo limite! ");
                API.moderateForceSkip();
        };
        clearTimeout(skipOnExceed);
        clearTimeout(this.timeouts.autoSkip);
        if (this.settings.a.afkRemoval) this.afkRemover();
        if (this.settings.b.autoSkip) this.timeouts.autoSkip = setTimeout(API.moderateForceSkip, e.media.duration * 1e3 + 4e3);
        this.refreshWL();
        sweetbot.saveData();
        console.log(2)
        for (var i in API.getUsers()){
            sweetbot.userData[API.getUsers()[i].id].lastWoot++;
        };
        console.log('dj advance');
        if (sweetbot.historyCheck()){ 
            setTimeout(function(){
                if (API.getDJ().language === 'pt') API.sendChat('@' + API.getDJ().username + ' Essa música já foi tocada!'); 
                else API.sendChat('@' + API.getDJ().username + ' Your song was in the history!');
                sweetbot.lockSkip();
            }, 600);
        };
    },
    eventJoin: function (e) {
        if (!this.userData[e.id]) this.newUser(e.id);
        this.userData[e.id].inRoom = true;
        this.userData[e.id].chatted = false;
        this.userData[e.id].joinTime = Date.now()
         if (e.id === 4820534) API.sendChat('/em Beta Tester The King Joined the Room!');
        API.chatLog(e.username + ' joined', true);
    },
    eventLeave: function (e) {
        if (!this.userData[e.id]) this.newUser(e.id);
        this.userData[e.id].inRoom = false, this.userData[e.id].afk.warn1 = 0, this.userData[e.id].afk.warn2 = false;
        if (this.waitList.indexOf(e.id) > -1) {
            this.userData[e.id].lastDC.pos = this.waitList.indexOf(e.id) + 1;
            this.userData[e.id].lastDC.song = this.stats.songCounter;
            this.userData[e.id].lastDC.afk = this.stats.afk;
            API.chatLog(e.username + " disconnected from the waitlist");
            this.refreshWL()
            this.userData[e.id].leaveTime = new Date().toString().split(' ')[4];
        }
        for (var t in this.addToWL) {
            if (this.addToWL[t].id == e.id) this.addToWL.splice(t, 1);
            break
        }
        API.chatLog(e.username + ' left', true);
    },
    eventVoteUpdate: function (e) {
        if (!this.userData[e.user.id]) this.newUser(e.user.id);
        if (this.userData[e.user.id].vote == 1)--this.userData[e.user.id].woots;
        else if (this.userData[e.user.id].vote == -1)--this.userData[e.user.id].mehs;
        if (e.vote == 1) ++this.userData[e.user.id].woots;
        else if (e.vote == -1){
            ++this.userData[e.user.id].mehs;
            if (this.settings.a.gettingMehs) sweetbot.getMehs();
        }
    var votesNegative = API.getScore().negative - API.getScore().grab;
        this.userData[e.user.id].vote = e.vote
        setTimeout(function(){ if (votesNegative === sweetbot.settings.a.mehlimit) {
            if (API.getDJ().language === 'pt') API.sendChat('@' + API.getDJ().username + ' Sua música recebeu muitos votos chatos!'); 
            else API.sendChat('@' + API.getDJ().username + ' Your song has received too many mehs!');
            API.moderateForceSkip();
        }}, 1500);
        if (e.vote === 1) sweetbot.userData[e.user.id].lastWoot = 0;
    },
    eventDjUpdate: function (e) {
        setTimeout(function(){$("#woot").click()}, 1000);
        if (this.settings.a.autoJoin && API.getWaitListPosition() == -1 && !this.getLocked()) API.djJoin();
        if (this.addToWL.length) this.addUsers();
        this.refreshWL();
        this.vars.nextDJ = API.getWaitList()[0]
        if (this.settings.a.forceWoot) this.forceWoot();
    },
    eventWaitlistUpdate: function (e) {
        if (this.addToWL.length) this.addUsers();
    },
    commandHandler: function (e) {
        var t = e.message.substr(1).split(" ");
        if (this.commands[t[0]]) API.moderateDeleteChat(e.cid);
        if (!this.vars.cmdOnCD && this.commands[t[0]]) {
            var n = API.getUser(e.uid).role;
            if (API.getUser(e.uid).gRole > 0) n = 6;
            if (n == 0 && this.settings.a.userCmds && !this.vars.userCmdOnCD && this.userCmds.indexOf(t[0]) > -1) n = 1;
            else if (n == 2 && this.settings.a.bouncerLock && this.bouncerPlus.indexOf(t[0]) > -1) n = 3;
            if (n >= this.commands[t[0]].r) {
                this.vars.cmdOnCD = true;
                this.timeouts.cmdCD = setTimeout(function () {
                    sweetbot.vars.cmdOnCD = false
                }, 2e3);
                this.commands[t[0]].f(t, e);
                if (API.getUser(e.uid).role == 0 && t[0] != "lottery") {
                    this.vars.userCmdOnCD = true;
                    var r = this.settings.a.userCmdCD * 1e3;
                    this.timeouts.userCmds = setTimeout(function () {
                        sweetbot.vars.userCmdOnCD = false
                    }, r)
                }
            } else if (!e.message.indexOf("/")) this.sock.emit("cmderror", "Vocêª não tem o rank necessario!")
        } else if (!e.message.indexOf("/")) {
            if (this.vars.cmdOnCD) this.sock.emit("cmderror", "Commands on cooldown");
            else this.sock.emit("cmderror", "Not a valid command")
        }
    },
    commands: {
        lock: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + " Usou lock]");
                API.moderateLockWaitList(true)
            },
            r: 3
        },
        cycle: {
            f: function (e, t) {
                if (API.getRoomInfo('cycle')) {
                    sweetbot.sendMsg("[" + t.un + "] Desativou DJ cycle");
                } else {
                    sweetbot.sendMsg('[' + t.un + '] Ativou DJ Cycle');
                }
                $.ajax({ type: 'PUT', url: '/_/booth/cycle', dataType: 'json', contentType: 'application/json', data: JSON.stringify({'shouldCycle':!API.getRoomInfo('cycle')}) })
            },
            r: 3
        },
        reload: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Recarregando! ");
                sweetbot.saveData();
                sweetbot.shutdown();
                setTimeout(function () {
                    $.getScript("https://dl.dropboxusercontent.com/s/7xsm30zdlapny4x/SweetChatBot.js")
                }, 2e3)
            },
            r: 4
        },
        kill: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Desligando.....");
                sweetbot.saveData();
                sweetbot.shutdown()
            },
            r: 4
        },
        "bouncer+": {
            f: function (e, t) {
                sweetbot.settings.a.bouncerLock = !sweetbot.settings.a.bouncerLock;
                if (sweetbot.settings.a.bouncerLock) {
                    if (e.length > 1) {
                        var n = parseInt(e[1]);
                        if (isNaN(n)) sweetbot.sendMsg("Erro!");
                        else {
                            sweetbot.timeouts.bouncerLock = setTimeout(function () {
                                bouncerLock = false
                            }, 1e3 * 60 * n);
                            sweetbot.sendMsg("[" + t.un + "] Bouncer+ Ativado! for " + n + " minutes.")
                        }
                    } else sweetbot.sendMsg("[" + t.un + "] Bouncer+ Ativado! ")
                } else {
                    clearTimeout(sweetbot.timeouts.bouncerLock);
                    sweetbot.sendMsg("[" + t.un + "] Bouncer+ Desativado!")
                }
            },
            r: 3
        },
        apocalypse: {
            f: function (e, t) {
                sweetbot.settings.b.apoc = !sweetbot.settings.b.apoc;
                if (sweetbot.settings.b.apoc) {
                    sweetbot.settings.b.apoc = true;
                    sweetbot.sendMsg(t.un + " Chamou o Apocalypse!");
                    var n = $("#chat-messages").children();
                    for (var r = 0; r < n.length; r++) API.moderateDeleteChat(n[r].className.substr(n[r].className.indexOf("cid-") + 4, 14))
                } else setTimeout(function () {
                    sweetbot.sendMsg(t.un + " Deu fim ao apocalypse!")
                }, 1e3)
            },
            r: 3
        },
        startlottery: {
            f: function(e, t) {
                sweetbot.sendMsg('[' + t.un + '] Lottery will start in 5 minutes! A loteria vai sortear em 5 minutos! esteja ativo no chat para participar!');
                setTimeout(sweetbot.boostLottery, 300000);
            },
            r: 3
        },
        duel: {
            f: function (e, t) {
                if (sweetbot.vars.duelReady && sweetbot.vars.duel[0] === undefined && sweetbot.getUserByName(t.message.substr(7)) !== t.uid && !sweetbot.userData[t.uid].muted){
                    if (sweetbot.getUserByName(t.message.substr(7))){
                        sweetbot.vars.duel.push(t.uid);
                        sweetbot.vars.duel.push(sweetbot.getUserByName(t.message.substr(7)));
                        sweetbot.sendMsg('@' + t.message.substr(7) + ', ' + t.un + '  Te chamou para o x1! Antes de dois minutos digite !accept para aceitar o x1. AVISO o perdedor ficará mutado por 2 minutos!');
                        setTimeout(function(){
                            sweetbot.vars.duel = [];
                        }, 120000);
                    } else {
                        sweetbot.sendMsg('[' + t.un + '] Usuario inválido!! Modo de usar: !duel @Usuario');
                    }
                }
            }, r: 0
        },
        accept: {
            f: function (e, t) {
                if (t.uid === sweetbot.vars.duel[1]) {
                    sweetbot.sendMsg(API.getUser(sweetbot.vars.duel[0]).username +' and ' + API.getUser(sweetbot.vars.duel[1]).username + ' Começaram o x1!');
                    var win = Math.round(Math.random());
                    win === 0 ? lose = 1 : lose = 0;
                    var winner = sweetbot.vars.duel[win];
                    var loser = sweetbot.vars.duel[lose];
                    setTimeout(function(){
                        sweetbot.sendMsg(API.getUser(winner).username + ' Ganhou o x1! Isso quer dizer que ' + API.getUser(loser).username + ' vai ficar mutado por 2 minutos! vai cryar? ');
                        sweetbot.vars.duelReady = false;
                        sweetbot.userData[loser].muted = true;
                        setTimeout(function(){sweetbot.userData[loser].muted = false;}, 120000);
                        setTimeout(function(){sweetbot.vars.duelReady = true}, sweetbot.settings.duelDelay * 1000);
                        sweetbot.vars.duel = [];
                    }, 5000)
                }
            }, r: 0
        },
        reject: {
            f: function(e, t) {
                if (t.uid === sweetbot.vars.duel[1]){
                    sweetbot.vars.duel = [];
                    sweetbot.vars.duelReady = true;
                    API.sendChat(t.un + ' Não aceitou o duelo.');
                }
            }, r: 0
        },
        dueldelay: {
            f: function (e, t) {
              if (!isNaN(parseInt(t.message.substr(11))) && parseInt(t.message.substr(11)) >= 30) {
                sweetbot.settings.duelDelay = parseInt(t.message.substr(11));
                sweetbot.sendMsg('[' + t.un + '] Duel delay is now ' + sweetbot.settings.duelDelay + ' seconds');
              } else {
                sweetbot.sendMsg('Invalid delay!');
              }
            },
            r: 2
        },
       clearchat: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + " Usou clearchat!]");
                var messages = $("#chat-messages > .message")
                for (var i in messages) {
                    !isNaN(i) && API.moderateDeleteChat(messages[i].attributes[1].value);
                }
            },
            r: 3
        },
        lockguard: {
            f: function (e, t) {
                sweetbot.settings.b.lockGuard = !sweetbot.settings.b.lockGuard;
                if (sweetbot.settings.b.lockGuard) sweetbot.sendMsg("[" + t.un + "] Lock Guard Ativo. Lista de espera será destravada caso fique por mais de 10 minutos travada!");
                else sweetbot.sendMsg("[" + t.un + "] Lock Guard desativado. Lista de espera vai ser liberada sendo destravada manualmente.")
            },
            r: 3
        },
        cycleguard: {
            f: function (e, t) {
                sweetbot.settings.b.cycleGuard = !sweetbot.settings.b.cycleGuard;
                if (sweetbot.settings.b.cycleGuard) sweetbot.sendMsg("[" + t.un + "] Cycle Guard Ativo. DJ Cycle vai ser automaticamente desativado caso seja esquecido por mais de 10 minutos! ");
                else sweetbot.sendMsg("[" + t.un + "] Cycle Guard desativado. DJ Cycle não será¡ desativado se for esquecido por mais de 10 minutos")
            },
            r: 3
        },
        timeguard: {
            f: function (e, t) {
                sweetbot.settings.b.timeGuard = !sweetbot.settings.b.timeGuard;
                if (sweetbot.settings.b.timeGuard) sweetbot.sendMsg("[" + t.un + "] Time Guard Ativo. Músicas acima de 7 minutos serÃƒÂ£o automaticamente puladas!");
                else sweetbot.sendMsg("[" + t.un + "] Time Guard desativado. Músicas acima de 7 minutos não serão automaticamente puladas!")
            },
            r: 3
        },
        autoskip: {
            f: function (e, t) {
                sweetbot.settings.b.autoSkip = !sweetbot.settings.b.autoSkip;
                if (sweetbot.settings.b.autoSkip) sweetbot.sendMsg("[" + t.un + "] Autoskip Ativado. Músicas serão puladas ao terminarem! ");
                else {
                    clearTimeout(sweetbot.timeouts.autoSkip);
                    sweetbot.sendMsg("[" + t.un + "] Autoskip desativado. Músicas não serão puladas no fim!")
                }
            },
            r: 3
        },
        voteskip: {
            f: function (e, t) {
                if (!isNaN(parseInt(t.message.substring(10))) && t.message.substring(10) !== ' ' && t.message.substring(10) !== undefined) {
                    sweetbot.settings.a.mehlimit = parseInt(t.message.substring(10));
                    sweetbot.sendMsg('[' + t.un + '] Voteskip limit is now ' + sweetbot.settings.a.mehlimit);
                    setTimeout(function(){ if (API.getScore().negative >= sweetbot.settings.a.mehlimit) {API.sendChat('@' + API.getDJ().username + ' Sua música recebeu muitos votos chatos! / Your song has received too many mehs!'); API.moderateForceSkip();}}, 1500);
                } else {
                    sweetbot.sendMsg('[' + t.un + '] Modo de usar : !voteskip [numero de mehs]');
                }
            },
            r: 3
        },
        boostlottery: {
            f: function (e, t) {
                sweetbot.settings.a.lottery = !sweetbot.settings.a.lottery;
                if (sweetbot.settings.a.lottery) sweetbot.sendMsg("[" + t.un + "] Bonus da loteria ativo. A cada hora um usuario ativo tem a chance de ganhar a posição 5 como prêmio na lista de espera!");
                else {
                    sweetbot.sendMsg("[" + t.un + "] Loteria Desativada!");
                    clearTimeout(sweetbot.timeouts.lotSelect)
                }
            },
            r: 3
        },
        move: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !move @usuario posição");
                else {
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado !.");
                    else {
                        var r = API.getWaitListPosition(n.id);
                        var i = parseInt(e[2].substr(e[2].length-2).trim());
                        if (isNaN(i)) sweetbot.sendMsg("[" + t.un + "] Erro!");
                        else if (i < 1 || i > 50) sweetbot.sendMsg("[" + t.un + "] Erro. (Posição deve ser entre 1 a 50)");
                        else if (n.id == API.getDJ().id) sweetbot.sendMsg("[" + t.un + "] Usuario está¡ atualmente tocando!");
                        else if (r > -1 && r != undefined) {
                            sweetbot.sendMsg("[" + t.un + " Usou move]");
                            API.moderateMoveDJ(n.id, i)
                        } else if (API.getWaitList().length < 50) {
                            sweetbot.sendMsg("[" + t.un + " Usou move]");
                            API.moderateAddDJ(n.id);
                            setTimeout(function () {
                                API.moderateMoveDJ(n.id, i)
                            }, 3e3)
                        } else {
                            var s = true;
                            for (var o in sweetbot.addToWL) if (sweetbot.addToWL[o].id == n.id) {
                                sweetbot.sendMsg("[" + t.un + "] Esse usuario já está¡ sendo adicionado!");
                                s = false;
                                break
                            }
                            if (s) {
                                sweetbot.addToWL.push({
                                    id: n.id,
                                    pos: i
                                });
                                sweetbot.sendMsg("[" + t.un + "] Adicionando " + n.username + " para a lista de espera na posição " + i + ". Posição: " + sweetbot.addToWL.length);
                                API.moderateLockWaitList(true)
                            }
                        }
                    }
                }
            },
            r: 3
        },
        lotreset: {
            f: function (e, t) {
                sweetbot.settings.a.globCounter = 0;
                sweetbot.sendMsg("[" + t.un + "] Loteria Resetada. A proxima rodada será nos proximos 60 minutos!")
            },
            r: 3
        },
        lotsync: {
            f: function (e, t) {
                sweetbot.settings.a.globCounter = (new Date).getMinutes();
                sweetbot.sendMsg("[" + t.un + "] Loteria sincronizada com o tempo atual. A Loteria vai ocorrer a cada hora!. (:00)")
            },
            r: 3
        },
        usercommands: {
            f: function (e, t) {
                if (e.length == 1) {
                    sweetbot.settings.a.userCmds = !sweetbot.settings.a.userCmds;
                    if (sweetbot.settings.a.userCmds) sweetbot.sendMsg("[" + t.un + "] Comandos de usuarios ativados!");
                    else sweetbot.sendMsg("[" + t.un + "] Comandos para usuarios  desativado! ")
                } else if (e.length == 2) {
                    var n = parseInt(e[1]);
                    if (isNaN(n)) sweetbot.sendMsg("[" + t.un + "] Erro! ");
                    else {
                        sweetbot.settings.a.userCmdCD = n;
                        sweetbot.sendMsg("[" + t.un + "] Comandos de usuarios alterados para " + n + " segundos!")
                    }
                } else sweetbot.sendMsg("[" + t.un + "] Modo de usar: !usercommands [opt: segundos]")
            },
            r: 3
        },
        usercmdcd: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Usuarios podem usar comandos a cada " + sweetbot.settings.a.userCmdCD + " seconds.");
                else {
                    var n = parseInt(e[1]);
                    if (isNaN(n)) sweetbot.sendMsg("[" + t.un + "] Erro!");
                    else {
                        sweetbot.settings.a.userCmdCD = n;
                        sweetbot.sendMsg("[" + t.un + "] Delay dos comandos de usuario adicionados para " + n + " Segundos!")
                    }
                }
            },
            r: 3
        },
        clearinbox: {
            f: function (e, t) {
                if (e.length == 2) {
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else {
                        sweetbot.userData[n.id].inbox.msg = "";
                        sweetbot.userData[n.id].inbox.un = "";
                        sweetbot.sendMsg("[" + t.un + "] " + n.username + "'s inbox limpa!")
                    }
                } else sweetbot.sendMsg("[" + t.un + "] Modo de usar: !clearinbox @usuario")
            },
            r: 3
        },
        lockskip: {
            f: function (e, t) {
                if (!sweetbot.vars.skipping && e.length <= 3) {
                    var n, r;
                    sweetbot.sendMsg("[" + t.un + " Usou lockskip!]");
                    switch (n) {
                    case "theme":
                        r = "@" + API.getDJ().username + " Essa música não faz parte dos temas permitidos, por favor, escolha outra!.";
                        break;
                    case "op":
                        r = "@" + API.getDJ().username + " Essa música é OVERPLAYED, escolha uma música diferente!.";
                        break;
                    case "history":
                        r = "@" + API.getDJ().username + "Essa música já¡ foi tocada, escolha uma diferente!.";
                        break;
                    case "rules":
                        r = "@" + API.getDJ().username + " Essa música não respeita as regras da sala, escolha uma música diferente!.";
                        break;
                    default:
                        r = false
                    }
                    if (r) API.sendChat(r);
                    sweetbot.lockSkip()
                }
            },
            r: 2
        },
        unlock: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + " usou unlock]");
                API.moderateLockWaitList(false)
            },
            r: 2
        },
        skip: {
            f: function (e, t) {
                if (!sweetbot.vars.skipping) {
                    sweetbot.sendMsg("[" + t.un + " usou skip]");
                    sweetbot.vars.skipping = true;
                    API.moderateForceSkip();
                    sweetbot.timeouts.skip = setTimeout(function () {
                        sweetbot.vars.skipping = false
                    }, 5e3)
                }
            },
            r: 2
        },
        add: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !add @usuario");
                else if (API.getWaitList().length < 50) {
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else if (n.wlIndex > -1) sweetbot.sendMsg("[" + t.un + "] Usuario já está na lista de espera!");
                    else if (n.id == API.getUser().id) {
                        sweetbot.sendMsg("[" + t.un + " usou add]");
                        API.djJoin();
                        sweetbot.sendMsg("joined the waitlist.")
                    } else {
                        API.moderateAddDJ(n.id);
                        API.sendChat('[' + t.un + '] Added  @' + n.username + '!');
                    }
                } else sweetbot.sendMsg("[" + t.un + "] Lista de espera está lotada!")
            },
            r: 2
        },
        remove: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !remove @Usuario");
                else {
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else if (API.getWaitListPosition(n.id) == undefined) sweetbot.sendMsg("[" + t.un + "] Usuario não está na lista de espera.");
                    else if (n.id == API.getUser().id) {
                        sweetbot.sendMsg("[" + t.un + "] usou remover]");
                        API.djLeave();
                        sweetbot.sendMsg("left the waitlist.")
                    } else {
                        API.moderateRemoveDJ(n.id);
                        API.sendChat('[' + t.un + '] Removed @' + n.username + '!');
                    }
                }
            },
            r: 2
        },
        dc: {
            f: function (e, t) {
                var n = API.getUser(t.uid).role;
                if (e.length > 1 && n < 2) return;
                var r = e.length == 1 ? {
                    username: t.un,
                    id: t.uid
                } : API.getUser(sweetbot.getUserByName(t.message.substr(5)));
                if (!r) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                else {
                    if (!sweetbot.userData[r.id]) sweetbot.newUser(r.id);
                    if (sweetbot.userData[r.id].lastDC.pos == -1) sweetbot.sendMsg("[" + t.un + "] Eu não vi " + r.username + " desconectar-se!");
                    else {
                        var i = sweetbot.userData[r.id].lastDC;
                        var s = r.username + " Desconectou-se " + (sweetbot.stats.songCounter - i.song) + " Música";
                        s += sweetbot.stats.songCounter - i.song == 1 ? " " : "s ";
                        s += "atrás na posição " + i.pos + ", com ";
                        s += sweetbot.stats.afk - i.afk + " AFK";
                        s += sweetbot.stats.afk - i.afk == 1 ? " removido. " : "s removidos, ";
                        if (sweetbot.stats.songCounter - i.song >= 11) s += "Faz muito tempo atrás!!";
                        else {
                            var o = API.getWaitListPosition(r.id);
                            var u = i.pos;
                            if (o != -1) API.moderateMoveDJ(r.id, u);
                            else if (API.getWaitList().length < 50) {
                                API.moderateAddDJ(r.id);
                                setTimeout(function () {
                                    API.moderateMoveDJ(r.id, u)
                                }, 3e3)
                                sweetbot.userData[r.id].lastDC.pos = -1;
                            } else {
                                var a = true;
                                for (var f in sweetbot.addToWL) if (sweetbot.addToWL[f].id == r.id) {
                                    a = false;
                                    s += "Usuario já está sendo adicionado!";
                                    break
                                }
                                if (a) {
                                    sweetbot.addToWL.push({
                                        id: r.id,
                                        pos: u
                                    });
                                    s += "Adicionando o Usuario na lista de espera na posição " + u + ".";
                                    API.moderateLockWaitList(true)
                                }
                                sweetbot.userData[r.id].lastDC.pos = -1;
                            }
                        }
                        sweetbot.sendMsg("[" + t.un + "] " + s + ' [' + sweetbot.userData[r.id].leaveTime + ']')
                    }
                }
            },
            r: 1
        },
        kick: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !kick @Usuario [minutos] (padrão 30 sec)");
                else if (API.getUser(sweetbot.getUserByName(e[1].substr(1))).role === 0){
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else {
                        var r = e.length == 3 ? parseInt(e[2]) * 1e3 * 60 : 30 * 1e3;
                        if (isNaN(r)) sweetbot.sendMsg("[" + t.un + "] Error. (NaN)");
                        else {
                            sweetbot.sendMsg("[" + t.un + " usou kick]");
                            API.moderateBanUser(n.id, 0);
                            setTimeout(function () {
                                $.ajax({
                                    type: "DELETE",
                                    url: "http://plug.dj/_/bans/moderate.unban",
                                    contentType: "application/json",
                                    data: '{"service":"moderate.unban","body":["' + n.id + '"]}'
                                })
                            }, r)
                        }
                    }
                }
            },
            r: 2
        },
        ban: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !ban @Usuario");
                else if (API.getUser( sweetbot.getUserByName(e[1].substr(1)) ).role === 0){
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else if (n.role) sweetbot.sendMsg("[" + t.un + "] Não é possível banir pessoas da staff!");
                    else {
                        sweetbot.sendMsg("[" + t.un + " usou ban]");
                        API.moderateBanUser(n.id, 0, 'f')
                    }
                }
            },
            r: 2
        },
        mute: {
            f: function (e, t) {
                if (!t.message.substr(7)) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !mute @Usuario");
                else {
                    var n = API.getUser(sweetbot.getUserByName(t.message.substr(7)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else {
                        if (!sweetbot.userData[n.id]) sweetbot.newUser(n.id);
                        if (sweetbot.userData[n.id].muted) sweetbot.sendMsg("[" + t.un + "] Usuario já está com mute!");
                        else if (n.role >= API.getUser(t.uid).role) sweetbot.sendMsg("[" + t.un + "] Não é possível mutar quem possui um rank maior que você!");
                        else {
                            sweetbot.userData[n.id].muted = true;
                            sweetbot.sendMsg("[" + t.un + "] Muted " + n.username + ".")
                        }
                    }
                }
            },
            r: 2
        },
        unmute: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !unmute @Usuario");
                else if (e[1] == "all" && !sweetbot.userData[t.uid].muted) {
                    for (i in sweetbot.userData) sweetbot.userData[i].muted = false;
                    sweetbot.sendMsg("[" + t.un + "] Unmuted all!")
                } else if (!sweetbot.userData[t.uid].muted){
                    var n = API.getUser(sweetbot.getUserByName(t.message.substr(9)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else {
                        if (!sweetbot.userData[n.id]) sweetbot.newUser(n.id);
                        if (!sweetbot.userData[n.id].muted) sweetbot.sendMsg("[" + t.un + "] Usuario não está com mute!");
                        else {
                            sweetbot.userData[n.id].muted = false;
                            sweetbot.sendMsg("[" + t.un + "] Unmuted " + n.username + ".")
                        }
                    }
                }
            },
            r: 2
        },
        voteratio: {
            f: function (e, t) {
                var n = e.length == 1 ? {
                    username: t.un,
                    id: t.uid
                } : API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                else {
                    var r;
                    if (!sweetbot.userData[n.id]) sweetbot.newUser(n.id);
                    if (sweetbot.userData[n.id].woots + sweetbot.userData[n.id].mehs == 0) r = "0.00";
                    else r = (sweetbot.userData[n.id].woots / (sweetbot.userData[n.id].woots + sweetbot.userData[n.id].mehs)).toFixed(2);
                    sweetbot.sendMsg("[" + t.un + "] " + n.username + " ~ Woots: " + sweetbot.userData[n.id].woots + " | Mehs: " + sweetbot.userData[n.id].mehs + " | Porcentagem: " + r)
                }
            },
            r: 1
        },
        afkreset: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !afkreset @Usuario ");
                else {
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else {
                        if (!sweetbot.userData[n.id]) sweetbot.newUser(n.id);
                        else sweetbot.userData[n.id].afk.time = Date.now();
                        sweetbot.sendMsg("[" + t.un + "] Tempo de AFK do Usuario " + n.username + " resetado!")
                    }
                }
            },
            r: 3
        },
        afkremoval: {
            f: function (e, t) {
                sweetbot.settings.a.afkRemoval = !sweetbot.settings.a.afkRemoval;
                if (sweetbot.settings.a.afkRemoval) sweetbot.sendMsg("[" + t.un + "] Removedor AFK Ativo ! Tempo limite AFK: " + sweetbot.settings.a.afkLimit + " minutos. Fique ativo no chat para evitar ser removido!"), sweetbot.afkRemover();
                else sweetbot.sendMsg("[" + t.un + "] Removedor AFK Desativado!")
            },
            r: 3
        },
        forcewoot: {
            f: function (e, t) {
                sweetbot.settings.a.forceWoot = !sweetbot.settings.a.forceWoot;
                if (sweetbot.settings.a.forceWoot) sweetbot.sendMsg("[" + t.un + "] ForceWoot Ativado! Vote enquanto estiver na lista de espera para evitar ser removido!"), sweetbot.forceWoot;
                else sweetbot.sendMsg("[" + t.un + "] ForceWoot AFK Desativado!");
            },
            r: 3
        },
        afklimit: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] O tempo limite AFK é " + sweetbot.settings.a.afkLimit + " minutos.");
                else {
                    var n = parseInt(e[1]);
                    if (isNaN(n)) sweetbot.sendMsg("[" + t.un + "] Erro! ");
                    else if (n < 10) sweetbot.sendMsg("[" + t.un + "] Erro! ( Precisa ser no minimo  60)");
                    else {
                        sweetbot.settings.a.afkLimit = n;
                        sweetbot.sendMsg("[" + t.un + "] Tempo limite de AFK adicionado para " + n + " minutos!")
                    }
                }
            },
            r: 2
        },
        afktime: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg("[" + t.un + "] Modo de usar: !afktime @Usuario");
                else {
                    var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                    else {
                        if (!sweetbot.userData[n.id]) sweetbot.newUser(n.id);
                        sweetbot.sendMsg("[" + t.un + "] " + n.username + " Não esteve ativo no chat em " + sweetbot.getTime(Date.now() - sweetbot.userData[n.id].afk.time))
                    }
                }
            },
            r: 2
        },
        status: {
            f: function (e, t) {
                var n = "Sweet Chat Bot " + sweetbot.version + " | Removedor de AFK: ";
                n += sweetbot.settings.a.afkRemoval ? 'Ativado | AFKs Removidos: ' : 'Desativado | AFK Removidos: '
                n += sweetbot.stats.afk + " | Tempo limite AFK: " + sweetbot.settings.a.afkLimit + " | ForceWoot: ";
                n += sweetbot.settings.a.forceWoot ? ' Ativado' : ' Desativado';
                n += " | Tempo ativo: " + sweetbot.getTime(Date.now() - sweetbot.stats.launchTime);
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 2
        },
        sessionstats: {
            f: function (e, t) {
                var n = "MÃƒÂºsicas: " + sweetbot.stats.songCounter + " | Woots: " + sweetbot.stats.woots + " | Mehs: " + sweetbot.stats.mehs + " | Grabs: " + sweetbot.stats.grabs + " | Loterias finalizadas " + sweetbot.stats.lot;
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 2
        },
        settings: {
            f: function (e, t) {
                var n = "Removedor de AFK: ";
                n += sweetbot.settings.a.afkRemoval ? "Ativado | " : "Desativado | ";
                n += "Bouncer+: ";
                n += sweetbot.settings.a.bouncerLock ? "Ativado | " : "Desativado | ";
                n += "Removed Filter: ";
                n += sweetbot.settings.b.removedFilter ? "Ativado | " : "Desativado | ";
                n += "Timeguard: ";
                n += sweetbot.settings.b.timeGuard ? "Ativado | " : "Desativado | ";
                n += "Cycleguard: ";
                n += sweetbot.settings.b.cycleGuard ? "Ativado | " : "Desativado | ";
                n += "Lockguard: ";
                n += sweetbot.settings.b.lockGuard ? "Ativado | " : "Desativado | ";
                n += "Comandos de usuÃƒÂ¡rios: ";
                n += sweetbot.settings.a.userCmds ? "Ativado" : "Desativado";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 2
        },
        active: {
            f: function (e, t) {
                var n = e.length == 1 ? 60 : parseInt(e[1]),
                 r = 0,
                 i;
                if (isNaN(n)) sweetbot.sendMsg("Error. (NaN)");
                else if (Date.now() - sweetbot.stats.launchTime < 1e3 * 60 * n) {
                    for (i in sweetbot.userData) if (sweetbot.userData[i].chatted)++r;
                    sweetbot.sendMsg("[" + t.un + "] " + r + " Usuario estavam ativos no chat desde quando o Sweet Chat Bot foi iniciado.")
                } else {
                    for (i in sweetbot.userData) if (Date.now() - sweetbot.userData[i].afk.time < 1e3 * 60 * n && sweetbot.userData[i].chatted)++r;
                    sweetbot.sendMsg("[" + t.un + "] " + r + " Usuario estavam ativos no chat desde os ultimos " + n + " minutos.")
                }
            },
            r: 2
        },
        motd: {
            f: function (e, t) {
                if (e.length == 1) sweetbot.sendMsg(sweetbot.settings.a.motd);
                else {
                    var n = e.slice(1).join(" "),
                     r = "";
                    if (e.length == 2) {
                        if (isNaN(parseInt(n))) {
                            sweetbot.settings.a.motd = n;
                            r += "Message set."
                        } else if (n < 1) sweetbot.sendMsg("[" + t.un + "] Intervalo precisa ser 1 ou mais.");
                        else {
                            sweetbot.settings.a.motdInt = n;
                            sweetbot.sendMsg("[" + t.un + "] Intervalo de mensagens alterado para " + n + " músicas!")
                        }
                    } else {
                        sweetbot.settings.a.motd = n;
                        r += "Mensagem adicionada."
                    }
                    if (!sweetbot.settings.a.customMotd && r.length) {
                        sweetbot.settings.a.customMotd = true;
                        r += " Enviando mensagem a cada " + sweetbot.settings.a.motdInt + " músicas!"
                    }
                    if (r.length) sweetbot.sendMsg("[" + t.un + "] " + r)
                }
            sweetbot.saveData();
            },
            r: 3
        },
        togglemotd: {
            f: function (e, t) {
                sweetbot.settings.a.customMotd = !sweetbot.settings.a.customMotd;
                if (sweetbot.settings.a.customMotd) sweetbot.sendMsg("[" + t.un + "] Mensagem  adicional ativada! Enviando mensagem a cada " + sweetbot.settings.a.motdInt + " músicas.");
                else sweetbot.sendMsg("[" + t.un + "] Mensagem  adicional desativada! Retornando as mensagens padrões!")
            },
            r: 3
        },
        chatfilter: {
            f: function (e, t) {
                sweetbot.settings.a.chatFilter = !sweetbot.settings.a.chatFilter;
                if (sweetbot.settings.a.chatFilter) sweetbot.sendMsg("[" + t.un + "] Filtro de chat ativado!");
                else sweetbot.sendMsg("[" + t.un + "] Filtro de chat desativado!");
            },
            r: 3
        },
        capslimit: {
            f: function (e, t) {
                if (!isNaN(parseInt(t.message.substr(11)))) {
                    sweetbot.vars.capsLimit = parseInt(t.message.substr(11));
                    API.sendChat("[" + t.un + "] Limite de caps em palavras alterado para " + sweetbot.vars.capsLimit);
                } else {
                    API.sendChat('[' + t.un + '] Modo de usar: !capslimit nûmero ');
                }
            },
            r: 3
        },
        lockdown: {
            f: function (e, t) {
                sweetbot.settings.b.lockDown = !sweetbot.settings.b.lockDown;
                if (sweetbot.settings.b.lockDown) sweetbot.sendMsg("[" + t.un + "] A sala está no modo LOCKDOWN, deletando todas as mensagens de usuario que não fazem parte da staff!");
                else sweetbot.sendMsg("[" + t.un + "] Lockdown desativado!")
            },
            r: 3
        },
        spamattack: {
            f: function (e, t) {
                sweetbot.settings.b.spamAtt = !sweetbot.settings.b.spamAtt;
                if (sweetbot.settings.b.spamAtt) sweetbot.sendMsg("[" + t.un + "] PROTEÇÃO DE SPAM ATIVA. EVITE ESTAR ATIVO NO CHAT PARA NÃO SER BANIDO!");
                else sweetbot.sendMsg("[" + t.un + "] Proteção de SPAM desativada!")
            },
            r: 3
        },
        spam: {
            f: function (e, t) {
                if (t.message.substring(6)){
                    sweetbot.arrays.spam.push(t.message.substring(6).trim());
                    sweetbot.sendMsg("[" + t.un + "] Adicionado a lista de spam!")
                    sweetbot.saveData();
                } else {
                    sweetbot.sendMsg('[' + t.un + '] Você precisa de uma palavra!')
                }
            },
            r: 3
        },
        removespam: {
            f: function (e, t) {
                if (t.message.substring(12)){
                    sweetbot.arrays.spam.rm(t.message.substring(12).trim());
                    sweetbot.sendMsg("[" + t.un + "] Removido da lista de spam!")
                    sweetbot.saveData();
                } else {
                    sweetbot.sendMsg('[' + t.un + '] Você precisa de uma palavra!')
                }
            },
            r: 3
        },
        cookie: {
            f: function (e, t) {
                if (e.length > 1) {
                    var n = API.getUser(sweetbot.getUserByName(t.message.substr(9)));
                    if (!n) sweetbot.sendMsg("[" + t.un + "] Eu não posso ver esse Usuario na sala! Sobra mais para mim! ");
                    else API.sendChat("@" + n.username + ", " + t.un + " " + sweetbot.arrays.cookie[Math.floor(Math.random() * sweetbot.arrays.cookie.length)])
                }
            },
            r: 0
        },
        image: {
            f: function (e, t) {
                if (API.getMedia().format == 1) {
                    sweetbot.sendMsg('[' + t.un + '] Image: http://i.ytimg.com/vi/' + API.getMedia().cid + '/maxresdefault.jpg');
                } else {
                    sweetbot.sendMsg('[' + t.un + '] não é possível obter imagens do soundcloud! Image does not work with soundcloud!');
                }
            },
            r: 0
        },
        theme: {
            f: function (e, t) {
                var n = " Any kind of good EDM! Qualquer tipo de música eletrônica boa! ";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 1
        },
        rules: {
            f: function (e, t) {
                var n = "Room Rules / Regras da sala: http://goo.gl/c6cPfv";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 1
        },
        events: {
            f: function (e, t) {
                sweetbot.sendMsg('[' + t.un + '] Fique ligado nos nossos eventos! Check out our events! http://goo.gl/3MCpse')
            },
            r: 1
        },
        faq: {
            f: function (e, t) {
                sweetbot.sendMsg('[' + t.un + '] Respostas para perguntas frequentes podem ser encontradas aqui: ')
            },
            r: 1
        },
     yt: {
            f: function (e, t) {
                sweetbot.sendMsg('[' + t.un + '] Inscreva-se no nosso canal!  ')
            },
            r: 1
        },
     blacklist: {
            f: function (e, t) {
                sweetbot.sendMsg('[' + t.un + '] Blacklist songs / Músicas banidas : http://goo.gl/eclL1i')
            },
            r: 1
        },
        emoji: {
            f: function (e, t) {
                var n = "Lista de Emoticons: http://www.emoji-cheat-sheet.com/ ";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 0
        },
        commands: {
            f: function (e, t) {
                if (API.getUser(t.uid).role > 1) var n = "Comandos do Sweet Chat Bot!: https://goo.gl/bMwVUP";
                else var n = "Comandos do Sweet Chat Bot!: http://bit.ly/MeC4GI  ";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 1
        },
        ping: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Pong!")
            },
            r: 1
        },
         pong: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Ping!")
            },
            r: 1
        },
     oki: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Doki!")
            },
            r: 1
        },
         doki: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Oki!")
            },
            r: 1
        },
        aquelacarinha: {
            f: function (e, t) {
                API.sendChat('[' + t.un + ']  ')
            }, r: 0
        },
        talvez: {
            f: function (e, t) {
                API.sendChat('[' + t.un + '] ')
            }, r: 0
        },
        vemmonstro: {
            f: function (e, t) {
                API.sendChat('[' + t.un + '] ')
            }, r: 0
        },
        changelog: {
            f: function (e, t) {
                var n = "Sweet Chat Bot changelog: http://bit.ly/1diPsQH! ";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 3
        },
        site: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Visite o nosso site e fique por dentro das novidades http://goo.gl/ZmFv1S !")
            },
            r: 1
        },
    duelhelp: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Você pode chamar um usuario para o x1 usando o comando !duel @usuario, o vencedor é escolhido aleatoriamente e o perdedor ficará¡ mutado por 2 minutos! use !reject para rejeitar o duelo!")
            },
            r: 1
        },
     swaphelp: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Você pode trocar a posição na fila de um usuario por outro utilizando o comando !swap @Usuario1 + @Usuario2, os lugares na fila serão trocados. ")
            },
            r: 1
        },
        help: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Possui dúvidas em como usar o plug? cheque este tutorial!")
            },
            r: 0
        },
    adblock: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] ")
            },
            r: 1
        },
    script: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] ")
            },
            r: 1
        },
    origemwoot: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Utilize o CEB-Woot! um autowoot prático, completo e constantemente atualizado, diferente de tudo que você já viu!  Acesse o link: http://origem-woot.com/")
            },
            r: 0
        },
    staff: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Para mais informações de como fazer parte da nossa staff, basta ir neste link: http://bit.ly/1Ntuh4A ")
            },
            r: 1
        },
        lothelp: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] A cada hora será escolhido aleatoriamente um usuario ativo para ser premiado com a posição 5  na lista de espera. Para participar, basta estar ativo no chat! ")
            },
            r: 1
        },
        votemutehelp: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] Você pode iniciar uma votação para mutar um usuario usando o comando !votemute @usuario, a votação será iniciada e será¡ bem sucedida se for votada por 20% dos usuarios da sala (para votar basta digitar !votemute), a pessoa votada será mutada por 15 minutos, caso a votação não atinja os 20% de usuarios ela será cancelada automaticamente apos um tempo. ")
            },
            r: 1
        },
    fb: {
            f: function (e, t) {
                var n = " Participe do nosso grupo no facebook!";
                for (var r = 1; r < e.length; r++) n += e[r] + " ";
                sweetbot.sendMsg("[" + t.un + "] " + n)
            },
            r: 1
        },
         link: {
            f: function (e, t) {
                 
                    var n = API.getMedia();
                    if (n.format == 1) sweetbot.sendMsg("[" + t.un + "] Link para a música atual: http://youtu.be/" + n.cid);
                    else {
                        SC.get("/tracks/" + n.cid, function (e) {
                            sweetbot.sendMsg("[" + t.un + "] Link para a música atual: " + e.permalink_url)
                        })
                    }
            },
            r: 0
        },
        msg: {
            f: function (e, t) {
                var n = API.getUser(sweetbot.getUserByName(e[1].substr(1)));
                if (!n) sweetbot.sendMsg("[" + t.un + "] Usuario não encontrado!");
                else if (sweetbot.userData[n.id].inbox.msg.length) sweetbot.sendMsg("[" + t.un + "] ");
                else if (Date.now() - sweetbot.userData[n.id].afk.time < 1e3 * 60 * 10) sweetbot.sendMsg("[" + t.un + "] Esse usuuario nao está tanto tempo AFK!");
                else {
                    sweetbot.userData[n.id].inbox.msg = e.slice(2).join(" ");
                    sweetbot.userData[n.id].inbox.un = t.un;
                    sweetbot.sendMsg("[" + t.un + "] Mensagem enviada para " + n.username + ".")
                }
            },
            r: 1
        },
        song: {
            f: function (e, t) {
                sweetbot.sendMsg("[" + t.un + "] " + API.getMedia().author + " - " + API.getMedia().title)
            },
            r: 0
        },
        ask: {
            f: function (e, t) {
                var n = Math.floor(Math.random() * sweetbot.arrays.questions.length);
                sweetbot.sendMsg("[" + t.un + "] " + sweetbot.arrays.questions[n] + "?")
            },
            r: 1
        },
        lottery: {
            f: function (e, t) {
                if (sweetbot.settings.a.lottery && t.uid == sweetbot.vars.lotWinner) {
                    check = true;
                    for (i in sweetbot.addToWL) if (sweetbot.addToWL[i].id == t.uid) {
                        sweetbot.sendMsg("[" + t.un + "] Você já está sendo adicionado! Será¡ sorteado um novo ganhador em breve!");
                        check = false;
                        break
                    }
                    if (check) {
                        sweetbot.vars.lotWinner = null;
                        clearTimeout(sweetbot.timeouts.lotSelect);
                        sweetbot.vars.lotWinners.length = 0;
                        ++sweetbot.stats.lot;
                        if (API.getWaitListPosition(t.uid) != undefined) {
                            API.moderateMoveDJ(t.uid, 5)
                        } else if (API.getWaitList().length < 50) {
                            API.moderateAddDJ(t.uid);
                            setTimeout(function () {
                                API.moderateMoveDJ(t.uid, 5)
                            }, 1500)
                        } else {
                            API.moderateLockWaitList(true);
                            sweetbot.addToWL.push({
                                id: t.uid,
                                pos: 5
                            });
                            sweetbot.sendMsg("[" + t.un + "] Movendo o ganhador da loteria para a posição 5. Queue: " + sweetbot.addToWL.length)
                        }
                    }
                    sweetbot.lastWinner = t.un;
                }
            },
            r: 0
        },
        lotwinner: {
            f: function(e, t) {
                sweetbot.sendMsg('[' + t.un + '] O ultimo ganhador da loteria foi : @' + sweetbot.lastWinner + ' !');
            },
            r: 2
        },
        jointime: {
            f: function(e, t){
                var user = sweetbot.getUserByName(t.message.substring(11));
                var joinTime = Date.now() - sweetbot.userData[user].joinTime;
                    var cd = 24 * 60 * 60 * 1000,
                        ch = 60 * 60 * 1000,
                        d = Math.floor(joinTime / cd),
                        h = '0' + Math.floor( (joinTime - d * cd) / ch),
                        m = '0' + Math.round( (joinTime - d * cd - h * ch) / 60000);
                if (sweetbot.getUserByName(t.message.substring(11))) sweetbot.sendMsg('[' + t.un + '] ' + t.message.substring(11) + ' joined ' + [h.substr(-2) + 'h', m.substr(-2) + 'm'].join(':') + ' ago');
                else sweetbot.sendMsg('Invalid User!');
            }, r: 2
        },
        wiki: {
            f: function(e, t) {
                if(typeof t.message.substring(6) == "undefined"){
                            API.sendChat("["+t.un+"] https://en.wikipedia.org/wiki/Special:Random");
                        }else{
                            var r = t.message.substring(6).replace(/ /g, "_");
                            $.getJSON("http://jsonp.appspot.com/?callback=?&url=" + escape("http://en.wikipedia.org/w/api.php?action=query&prop=links&format=json&titles="+r.replace(/ /g,"_")),
                                function(wikiData){
                                    if (!wikiData || !wikiData.query || !wikiData.query.pages) // there's an error. pssh, don't let anyone know ;)
                                        return API.sendChat("["+t.un+"] http://en.wikipedia.org/wiki/"+r+" (NOT GUARANTEED TO BE CORRECT)");
                                    if (wikiData.query.pages[-1]) {
                                        API.sendChat("["+t.un+"] article not found");
                                    }else{
                                        for (var i in wikiData.query.pages)
                                            // note: the #... is just to make the url look nicer
                                            return API.sendChat("["+t.un+"] https://en.wikipedia.org/wiki/?curid="+i+"#"+escape(wikiData.query.pages[i].title) );
                                    }
                                }
                            );
                        }
            },
            r: 1
        },
        google: {
            f: function(e, t) {
                if (typeof t.message.substring(8) == "undefined") {
                    API.sendChat("["+t.un+"] Please specify a query!");
                } else {
                    var r = t.message.substring(8);
                    API.sendChat("["+t.un+"] https://google.com/search?q="+escape(r.replace(/ /g,"+")));
                }
            },
            r: 0
        },
        youtube: {
            f: function(e, t) {
                if (typeof t.message.substring(9) == "undefined") {
                    API.sendChat("["+t.un+"] Please specify a query!");
                } else {
                    var r = t.message.substring(9);
                    API.sendChat("["+t.un+"] https://www.youtube.com/results?search_query="+escape(r.replace(/ /g,"+")));
                }
            },
            r: 0
        },
/*        wikilang: {
            f: function(e, t) {
                if(typeof t.message.substring(6) == "undefined"){
                            API.sendChat("["+t.un+"] https://" + API.getUser(t.uid).language + ".wikipedia.org/wiki/Special:Random");
                        }else{
                            var r = t.message.substring(6).replace(/ /g, "_");
                            $.getJSON("http://jsonp.appspot.com/?callback=?&url=" + escape("http://" + API.getUser(t.uid).language + ".wikipedia.org/w/api.php?action=query&prop=links&format=json&titles="+r.replace(/ /g,"_")),
                                function(wikiData){
                                    if (!wikiData || !wikiData.query || !wikiData.query.pages) // there's an error. pssh, don't let anyone know ;)
                                        return API.sendChat("["+t.un+"] http://" + API.getUser(t.uid).language + ".wikipedia.org/wiki/"+r+" (NOT GUARANTEED TO BE CORRECT)");
                                    if (wikiData.query.pages[-1]) {
                                        API.sendChat("["+t.un+"] article not found");
                                    }else{
                                        for (var i in wikiData.query.pages)
                                            // note: the #... is just to make the url look nicer
                                            return API.sendChat("["+t.un+"] https://" + API.getUser(t.uid).language + ".wikipedia.org/wiki/?curid="+i+"#"+escape(wikiData.query.pages[i].title) );
                                    }
                                }
                            );
                        }
            },
            r: 1
        },*/
        eta: {
            f: function(e, t){
                var a = 0;
                var c = Math.floor(API.getTimeRemaining() / 60);
                var d = Math.round(API.getTimeRemaining() - c * 60);
                _.each(sweetbot.stats.lengths, function(data){ a += data; });
                b = Math.round(a / sweetbot.stats.lengths.length);
                if (API.getWaitListPosition(t.uid) === -1) sweetbot.sendMsg("[" + t.un + "] Você não está¡ na lista de espera e o tempo total aproximado é " + (b * API.getWaitList().length + c) + " minutos e " + d + " segundos.");
                else if (!isNaN(API.getWaitListPosition(t.uid)) && API.getWaitListPosition(t.uid) !== 0) sweetbot.sendMsg("[" + t.un + "] Você está na posição " + (API.getWaitListPosition(t.uid) + 1)  + "/" + API.getWaitList().length + " e vai tocar em aproximadamente " + (b * (API.getWaitListPosition(t.uid) + 1) + c) + " minutos e " + d + " segundos.");
                else if (!isNaN(API.getWaitListPosition(t.uid)) && API.getWaitListPosition(t.uid) === 0) sweetbot.sendMsg("[" + t.un + "] Você está na posição " + (API.getWaitListPosition(t.uid) + 1)  + "/" + API.getWaitList().length + " e vai tocar em aproximadamente " + c + " minutos e " + d + " segundos.");
            },
            r: 0
        },
        whois: {
            f: function(e, t){
                    var name = t.message.substr(8), id = sweetbot.getUserByName(name), user = API.getUser(id), badge, rank, profile;
                    var a = user.joined.split('-');
                    b = a[2].split(' ')[0];
                    c = [a[1], b, a[0]];
                    joined = c.join('/');
                    switch (user.badge) {case 1:badge = 'Beta Tester';break;case 2:badge = 'Early Adopter';break;case 3:badge = 'Original Gangster';break;case 4:badge = 'Plug Superstar';break;default:badge = 'None'; break;}
                    switch (user.role) {
                        case 0:
                            rank = 'User';
                        break;
                        case 1:
                            rank = 'Resident DJ';
                        break;
                        case 2: 
                            rank = 'Bouncer';
                        break;
                        case 3:
                            rank = 'Manager';
                        break;
                        case 4:
                            rank = 'Co-Host';
                        break;
                        case 5:
                            rank = 'Host';
                        break;
                    }
                    if (user.id !== API.getUser().id) {
                        $.ajax({type: 'GET', url: '/_/users/' + id}).done(function(_){
                            profile = 'https://plug.dj/@/' + _.data[0].slug
                            profile = user.level > 4 ? profile : 'No Profile!';
                            if (profile !== 'No Profile!') {
                                console.log(profile)
                                $.getJSON("https://api-ssl.bitly.com/v3/shorten?callback=?", 
                                    { 
                                        "format": "json",
                                        "access_token": "fe051f97330b459bbe2bba5c6c98e43a9988e9f1",
                                        "login": "derpthebass",
                                        "longUrl": profile
                                    }).done(function(response) {
                                        console.log(response)
                                        API.sendChat("[" + t.un + "] Username: " + name + " | Id: " + id +" | Rank: " + rank + " | Level: " + user.level + " | Data que entrou: " + joined + " | Badge: " + badge + " | Profile: " + response.data.url);
                                    }
                                );
                            } else {
                                API.sendChat("[" + t.un + "] Username: " + name + " | Id: " + id +" | Rank: " + rank + " | Level: " + user.level + " | Data que entrou: " + joined + " | Badge: " + badge + " | Profile: " + profile);
                            }
                        });
                    } else API.sendChat('[' + t.un + '] Usuario invalido! Modo de usar: !whois @usuario');
            },
            r: 2
        },       
        op: {
            f: function(e, t){
                sweetbot.sendMsg('[' + t.un + '] Overplayed songs / Músicas OP:  ');
            },
            r: 0
        },
        profile: {
            f: function(e, t) {
                var name = t.message.substr(10), id = sweetbot.getUserByName(name), user = API.getUser(id), profile;
                if (id !== API.getUser().id) {
                        $.ajax({type: 'GET', url: '/_/users/' + id}).done(function(_){
                            profile = 'https://plug.dj/@/' + _.data[0].slug
                            profile = user.level > 4 ? profile : 'No Profile!';
                            if (profile !== 'No Profile!') {
                                console.log(profile)
                                $.getJSON("https://api-ssl.bitly.com/v3/shorten?callback=?", 
                                    { 
                                        "format": "json",
                                        "access_token": "fe051f97330b459bbe2bba5c6c98e43a9988e9f1",
                                        "login": "derpthebass",
                                        "longUrl": profile
                                    }).done(function(response) {
                                        console.log(response)
                                        API.sendChat("[" + t.un + "] " + name + "'s profile: " + response.data.url);
                                    }
                                );
                            } else {
                                API.sendChat("[" + t.un + "] " + name + 'Ainda nao possui um perfil!');
                            }
                        });
                    } else API.sendChat('[' + t.un + '] Usuario invalido! Modo de usar: !profile @usuario');
            }, r: 1
        },
        votemute: {
            f: function(e, t){
                console.log(sweetbot.getUserByName(t.message.substr(11)));
                console.log(t.message.substr(11));
                if (!sweetbot.vars.voteMute && sweetbot.getUserByName(t.message.substr(11))) {
                    var name = t.message.substr(11), id = sweetbot.getUserByName(name), user = API.getUser(id);
                    console.log(name + ' ' + id);
                    sweetbot.vars.voteMuter = t.uid;
                    sweetbot.vars.voteMute = true;
                    sweetbot.vars.muteVotes++;
                    sweetbot.vars.muteVoters.push(t.uid);
                    API.sendChat(t.un + ' has started a Mute Vote against ' + name.trim() + '! Type !votemute within 2 minutes to vote to has this user muted for 30 minutes.');
                    var timer = setTimeout(function(){
                        if (Math.round(sweetbot.vars.muteVotes / API.getUsers().length * 100) >= 30) {
                            API.sendChat('Mute Vote has succeeded (' + sweetbot.vars.muteVotes + ' votes)');
                            API.moderateMuteUser(id, 1, API.MUTE.MEDIUM);
                        } else {
                            API.sendChat('Mute Vote failed (' + sweetbot.vars.muteVotes + ' votes)');
                        }
                        sweetbot.vars.voteMute = false;
                        sweetbot.vars.muteVotes = 0;
                        sweetbot.vars.muteVoters = [];
                        sweetbot.vars.voteMuter = t.uid;
                    }, 120000);
                } else if (sweetbot.vars.muteVoters.indexOf(t.uid) === -1 && sweetbot.vars.voteMute) {
                    API.sendChat('[' + t.un + '] Voted!');
                    sweetbot.vars.muteVoters.push(t.uid);
                    sweetbot.vars.muteVotes++;
                } else if (t.message.substr(10) == 'cancel' && (API.getUser(t.uid).role > 2 || t.uid == sweetbot.vars.muteVoter)) {
                    clearTimeout(timer);
                    sweetbot.vars.voteMute = false;
                    sweetbot.vars.muteVotes = 0;
                    sweetbot.vars.muteVoters = [];
                    sweetbot.vars.voteMuter = t.uid;
                    API.sendChat('Vote Mute canceled!');
                } else if (sweetbot.vars.muteVoters.indexOf(t.uid) > -1) {
                    API.sendChat('You\'ve already voted!');
                } else {
                    API.sendChat('Invalid user!');
                }
            },
            r: 0
        },
        swap: {
            f: function(e, t){
                if (!t.message.split('@')[1] || !t.message.split('@')[2]) {
                    API.sendChat('[' + t.un + '] Modo de usar: !swap @usuario1 @usuario2');
                    return;
                }
  
                var name = t.message.split('@')[1], id = sweetbot.getUserByName(name), user = API.getUser(id);
                var name2 = t.message.split('@')[2], id2 = sweetbot.getUserByName(name2), user2 = API.getUser(id2);
  
                var firstPos = API.getWaitListPosition(id), secondPos = API.getWaitListPosition(id2);
  
                if (firstPos > -1 && secondPos > -1) {
                    API.sendChat('[' + t.un + '] Swapped ' + name + ' for ' + name2 + '!');
                    API.moderateMoveDJ(id, secondPos);
                    API.moderateMoveDJ(id2, firstPos + 1);
                } else {
                    API.sendChat('[' + t.un + '] Ambos os usuarios precisam estar na lista de espera!');
                }
            },
            r: 3
        },
        removedfilter: {
            f: function(e, t) {
                sweetbot.settings.b.removedFilter = !sweetbot.settings.b.removedFilter;
                API.sendChat('[' + t.un + '] Removed Filter is now ' + sweetbot.settings.b.removedFilter);
            }, 
            r: 3
        },
        execute: {
            f: function(e, t) {
                var name = t.message.substr(10), id = sweetbot.getUserByName(name);
  
                if (id) {
                    sweetbot.vars.execute.push(id);
                    API.sendChat('[' + t.un + '] ' + name + ' Será executado!');
                } else {
                    API.sendChat('[' + t.un + '] Modo de usar: !execute @usuario ')
                }
            },
            r: 4
        },
        desver: {
            f: function(e, t) {
                var name = t.message.substr(9), id = sweetbot.getUserByName(name), pass = false;
  
                if(API.getUser(id).role < (API.getUser(t.uid).role || API.getUser(t.uid).gRole)) pass = true;
  
                if (id && pass) {
                    API.sendChat('[' + t.un + '] Usou desver no (a) ' + name);
                } else if (id && !pass) {
                    API.sendChat( '[' + t.un + '] !desver só  pode ser usado em ranks menores que o seu!');
                    return;
                } else {
                    API.sendChat('[' + t.un + '] Modo de usar: !desver @usuario');
                } 
  
                for(var i in $('#chat-messages > .message')){
                    if ($('#chat-messages > .message')[i].attributes[1].value.startsWith(id.toString())) API.moderateDeleteChat($('#chat-messages > .message')[i].attributes[1].value);
                }
            }, r: 3
        },
        ruleskip: {
            f: function(command, t) {
                if(command[1].length === 11){
                        sweetbot.arrays.ruleSkip[command[1]] = {id: command[1], rule: t.message.substring(22)};
                        console.log('youtube ruleskip');
                        $.getJSON("https://gdata.youtube.com/feeds/api/videos/"+command[1].substr(2)+"?alt=json", function(json){
                            setTimeout(function(){
                                if(typeof json.data.title !== 'undefined'){
                                    API.sendChat('[' + t.un + '] ' + json.data.title+' added to ruleskip');
                                }else{
                                    API.sendChat('[' + t.un + '] Added to ruleskip');
                                }
                            }, 500)
                        });
                    }else if(command[1].length === 8){
                        console.log('soundcloud ruleskip')
                        sweetbot.arrays.ruleSkip[command[1]] = {id: command[1], rule: t.message.substring(20)};
                        SC.get('/tracks', {ids: command[1]}, function(tracks) {
                            if(tracks[0].title !== undefined){
                                API.sendChat('[' + t.un + '] ' + tracks[0].title+' added to ruleskip');
                            }else{
                                API.sendChat('[' + t.un + '] Added to ruleskip');
                            }
                        });
                    }else if(typeof sweetbot.arrays.ruleSkip[API.getMedia().cid] === 'undefined'){
                    sweetbot.arrays.ruleSkip[API.getMedia().cid] = {id: API.getMedia().cid, rule: t.message.substring(10)};
                    API.sendChat('[' + t.un + '] ' + API.getMedia().author + ' - ' +API.getMedia().title+' added to ruleskip');
                    API.moderateForceSkip();
                }
                    sweetbot.saveData();
            }, r: 2
        },
        checkruleskip: {
            f: function(command, t) {
                if(typeof command[1] !== 'undefined'){
                    if(typeof sweetbot.arrays.ruleSkip[command[1]] !== 'undefined') API.sendChat('[' + t.un + '] ' + command[1]+' is in the ruleskip array!');
                    else API.sendChat('[' + t.un + '] ' + command[1]+' is not in the ruleskip array!');
                }else{
                    if(typeof sweetbot.arrays.ruleSkip[API.getMedia().cid] !== 'undefined') API.sendChat('[' + t.un + '] ' + API.getMedia().cid+' is in the ruleskip array')
                    else API.sendChat('[' + t.un + '] ' + API.getMedia().id + ' is not in the ruleskip array');
                }
            }, r: 0
        },
        ruleskipdelete: {
            f: function(command, t) {
                if(typeof command[1] !== 'undefined' && typeof sweetbot.arrays.ruleSkip[command[1]] !== 'undefined'){
                    delete sweetbot.arrays.ruleSkip[command[1]];
                    API.sendChat('[' + t.un + '] ' + command[1]+' removed from ruleskip');
                }else if (typeof command[1] === 'undefined' && typeof sweetbot.arrays.ruleSkip[API.getMedia().id] !== 'undefined'){
                    delete sweetbot.arrays.ruleSkip[API.getMedia().cid];
                    API.sendChat('[' + t.un + '] ' + API.getMedia().id+' removed from ruleskip');
                }else if(typeof command[1] !== 'undefined'){
                    API.sendChat('[' + t.un + '] ' + command[1]+' was not in the ruleskip array!');
                }else{
                    API.sendChat('[' + t.un + '] ' + API.getMedia().id+' was not in the ruleskip array!');
                }
                sweetbot.saveData()
            }, r: 2
        },
        ruleskiplist: {
            f: function(e, t) {
            API.sendChat('[' + t.un + '] ' + _.keys(sweetbot.arrays.ruleSkip).join(', '));
            }, r: 3
        },     
        rule: {
            f: function(e, t) {
                switch (e[1]) {
                    case '1':
                        API.sendChat('[' + t.un + '] Rule 1 - Vídeo indisponível');
                    break;
                    case '2':
                        API.sendChat('[' + t.un + '] Rule 2 - Música  OP');
                    break;
                    case '3':
                        API.sendChat('[' + t.un + '] Rule 3 - Música contendo nudez ou pornografia (NSFW) ');
                    break;
                    case '4':
                        API.sendChat('[' + t.un + '] Rule 4 - Tema incorreto para a sala!');
                    break;
                    case '5':
                        API.sendChat('[' + t.un + '] Rule 5 - Música a cima dos 6:30 minutos! ');
                    break;
                    case '34':
                        API.sendChat('[' + t.un + '] Rule 34 - Você não vai querer saber o que é isso!');
                        break;
                    case '99':
                        API.sendChat('[' + t.un + '] Rule 99 - Apenas não..');
                    break;
                }
            }, r: 0
        },
        taco: {
            f: function(command, t) {
                    if(typeof command[1] == "undefined"){
                        var crowd = API.getUsers();
                        var randomUser = Math.floor(Math.random() * crowd.length);
                        var randomTaco = Math.floor(Math.random() * sweetbot.vars.tacos.length);
                        var randomSentence = Math.floor(Math.random() * 4);
                        switch(randomSentence){
                            case 0:
                                API.sendChat("@" + crowd[randomUser].username + ", take this " + sweetbot.vars.tacos[randomTaco] + ", you bitch!");
                                break;
                            case 1:
                                API.sendChat("@" + crowd[randomUser].username + ", quickly! Eat this " + sweetbot.vars.tacos[randomTaco] + " before " + t.un + " does!");
                                break;
                            case 2:
                                API.sendChat("One free " + sweetbot.vars.tacos[randomTaco] + " for you, @" + crowd[randomUser].username + ". :3");
                                break;
                            case 3:
                                API.sendChat(t.un + " throws a " + sweetbot.vars.tacos[randomTaco] + " at @" + crowd[randomUser].username + "!");
                                break;
                        }
                    }else{
                        if(command[1].indexOf("@") === 0) command[1] = command[1].substring(1);
                        var randomTaco = Math.floor(Math.random() * sweetbot.vars.tacos.length);
                        var randomSentence = Math.floor(Math.random() * 4);
                        switch(randomSentence){
                            case 0:
                                API.sendChat("@" + sweetbot.cleanString(command[1]) + ", take this " + sweetbot.vars.tacos[randomTaco] + ", you bitch!");
                                break;
                            case 1:
                                API.sendChat("@" + sweetbot.cleanString(command[1]) + ", quickly! Eat this " + sweetbot.vars.tacos[randomTaco] + " before " + t.un + " does!");
                                break;
                            case 2:
                                API.sendChat("One free " + sweetbot.vars.tacos[randomTaco] + " for you, @" + sweetbot.cleanString(command[1]) + ". :3");
                                break;
                            case 3:
                                API.sendChat(t.un + " throws a " + sweetbot.vars.tacos[randomTaco] + " at @" + sweetbot.cleanString(command[1]) + "!");
                                break;
                        }
                    }
            }, r: 0
        },
        hug: {
            f: function(command, t) {
                if(typeof command[1] == "undefined"){
                    var crowd = API.getUsers();
                    var randomUser = Math.floor(Math.random() * crowd.length);
                    var randomSentence = Math.floor(Math.random() * 4);
                    switch(randomSentence){
                        case 0:
                            API.sendChat("Abraços? Esqueça isso!");
                            setTimeout(function(){
                                API.sendChat(t.un + " Pegou na bundinha do(a) @"+crowd[randomUser].username+" ':smiling_imp:");
                            }, 650);
                            break;
                        case 1:
                            API.sendChat(t.un + " Deu a @"+crowd[randomUser].username+" Um grande e apertado abraço de urso!");
                            break;
                        case 2:
                            API.sendChat(t.un + " Deu a @"+crowd[randomUser].username+" Um abraço carinhoso!");
                            break;
                        case 3:
                            API.sendChat(t.un + " Deu a @"+crowd[randomUser].username+" Um abraço desajeitado!");
                            break;
                          
                    }
                }else{
                    if(command[1].indexOf("@") === 0) command[1] = command[1].substring(1);
                    var crowd = API.getUsers();
                    var randomUser = Math.floor(Math.random() * crowd.length);
                    var randomSentence = Math.floor(Math.random() * 4);
                    switch(randomSentence){
                        case 0:
                            API.sendChat("Abraços? Esqueça isso!");
                            setTimeout(function(){
                                API.sendChat(t.un + " Pegou na bundinha do(a) @"+sweetbot.cleanString(command[1])+" ':smiling_imp:");
                            }, 650);
                            break;
                        case 1:
                            API.sendChat(t.un + " Deu a @"+sweetbot.cleanString(command[1])+" Um grande e apertado abraço de urso!");
                            break;
                        case 2:
                            API.sendChat(t.un + " Deu a @"+sweetbot.cleanString(command[1])+" Um abraço carinhoso!");
                            break;
                        case 3:
                            API.sendChat(t.un + " Deu a @"+sweetbot.cleanString(command[1])+" Um abraço desajeitado!");
                            break;
                    }
                }
            }, r: 0
        },
        run: {
            f: function(e, t) {
                a = sweetbot.cleanString(t.message.substr(5));
                console.log(a);
                b = new Function(a);
                b();
            }, r: 5
        },
        afkmessage: {
            f: function(e, t) {
                if (t.message.substr(12) !== ('' && ' ')) {
                    sweetbot.userData[t.uid].afkMessage = t.message.substr(12);
                    API.sendChat('[' + t.un + '] Mensagem AFK adicionada!  Será¡ desativada na proxima vez que você digitar no chat!');
                } else {
                    API.sendChat('[' + t.un + '] Modo de usar: !afkmessage (afkmessage)');
                }
            }, r: 0
        },
        historyguard: {
            f: function(e, t) {
                sweetbot.settings.a.historyGuard = !sweetbot.settings.a.historyGuard;
                if (sweetbot.settings.a.historyGuard) sweetbot.sendMsg("[" + t.un + "] HistoryGuard Ativado! Músicas que já foram tocadas serão automaticamente puladas!");
                else sweetbot.sendMsg("[" + t.un + "] HistoryGuard desativado! Músicas que j´s foram tocadas não serão automaticamente puladas!");
            }, r: 3
        }
    },
    messageDeletion: function (e, t, n) {
        var r = false,
         i, s, o = e.message.toLowerCase();
        if (n < 2) {
            for (i in this.arrays.off) if (o.indexOf(this.arrays.off[i]) > -1) s = "offense";
            if (o.indexOf("http://adf.ly/") > -1) s = "adfly";
            if (o.indexOf("plug.dj/") > -1 && o.indexOf('.plug.dj') === -1) {
                for (i in this.arrays.links) if (o.indexOf(this.arrays.links[i]) > -1) r = true;
                if (!r) s = "roomlink"
            }
            if (e.message == e.message.toUpperCase() && e.message.length > sweetbot.vars.capsLimit) s = "caps";
            if (s) {
                API.moderateDeleteChat(t);
                if (s == "adfly") API.sendChat("@" + e.un + " Por favor, troque o seu programa de autowoot! esse possui vírus! ");
                else if (s == "roomlink") API.sendChat("@" + e.un + " Por favor, não faça propagandas de salas! ");
                else if (s == "caps") API.sendChat("@" + e.un + " Por favor, não utilize o caps! Calm down with the caps! ")
            }
        }
    },
    shortenURL: function(e) {
        n = e.message;
        if ((n.indexOf('http://') > -1 || n.indexOf('https://') > -1) && n.substring(n.indexOf('http')).split(' ', 1)[0].length > 59 && e.uid !== API.getUser().id) {
            API.moderateDeleteChat(e.cid);
            $.getJSON(
                "https://api-ssl.bitly.com/v3/shorten?callback=?", 
                { 
                    "format": "json",
                    "access_token": "fe051f97330b459bbe2bba5c6c98e43a9988e9f1",
                    "login": "derpthebass",
                    "longUrl": n.substring(n.indexOf('http')).split(' ', 1)[0]
                },
                function(response)
                {
                    API.sendChat('[' + e.un + '] Shortened URL: ' + response.data.url);
                }
            );
        }
    },
/*    afkRemover: function () {
        var e = API.getWaitList(),
         t = Date.now(),
         n = e.length < 1 ? e.length : 20,
         r, i, s, o, u;
        while (n--) {
            u = e[n].id;
            if (!sweetbot.userData[u]) sweetbot.newUser(u);
            o = sweetbot.userData[u], r = o.afk.time < o.joinTime ? o.joinTime : o.afk.time, i = o.afk.warn1, s = o.afk.warn2;
            if (t - r >= sweetbot.settings.a.afkLimit * 60 * 1e3 && !i && API.getUser(u).wlIndex == 19) {
                o.afk.warn1 = t;
                API.sendChat("@" + e[n].username + " AFK Time: " + sweetbot.getTime(t - r) + ". Esteja ativo no chat em 4 minutos ou irei remover vocÃƒÂª! / Chat in 4 minutes or i will remove you from the waitlist! ")
            } else if (i && t - i >= 2 * 60 * 1e3 && t - r <= sweetbot.settings.a.afkLimit * 60 * 1e3 + 60 * 120 * 1e3 && !s && API.getUser(u).wlIndex == 14) {
                o.afk.warn2 = true;
                API.sendChat("@" + e[n].username + " last warning. (AFK) / ultimo aviso (AFK)")
            } else if (t - i >= 4 * 60 * 1e3 && i && API.getUser(u).wlIndex == 9) {
                API.moderateRemoveDJ(u);
                o.afk.warn1 = 0, o.afk.warn2 = false;
                ++sweetbot.stats.afk;
                API.sendChat("@" + e[n].username + " chat at least once every " + sweetbot.settings.a.afkLimit + " minutes if you want to DJ. Esteja ativo no chat pelo menos uma vez em " + sweetbot.settings.a.afkLimit + " minutos se vocÃƒÂª quer ser o DJ!")
            }
        }
    },*/
    afkRemover: function () {
        var waitList = API.getWaitList(), now = Date.now(), index = [waitList[9], waitList[6], waitList[4]];
        if (now - sweetbot.userData[index[0].id].afk.time >= sweetbot.settings.a.afkLimit * 60000) {
            if (index[0].language === 'pt') API.sendChat('@' + index[0].username + ' Tempo AFK - ' + sweetbot.getTime(now - sweetbot.userData[index[0].id].afk.time) + ' | Esteja ativo no chat em atÃƒÂ© 5 mÃƒÂºsicas ou irei remover vocÃƒÂª!');
            else API.sendChat('@' + index[0].username + ' AFK Time - ' + sweetbot.getTime(now - sweetbot.userData[index[0].id].afk.time) + ' | Chat in 5 songs or I will remove you');
        };
        if (now - sweetbot.userData[index[1].id].afk.time >= sweetbot.settings.a.afkLimit * 60000) {
            if (index[1].language === 'pt') API.sendChat('@' + index[1].username + ' Tempo AFK - ' + sweetbot.getTime(now - sweetbot.userData[index[1].id].afk.time) + ' | Ultimo aviso. Esteja ativo no chat em atÃƒÂ© 2 mÃƒÂºsicas ou irei remover vocÃƒÂª !');
            else API.sendChat('@' + index[1].username + ' AFK Time - ' + sweetbot.getTime(now - sweetbot.userData[index[1].id].afk.time) + ' | Last warning. Chat in 2 songs or I will remove you');
        };
        if (now - sweetbot.userData[index[2].id].afk.time >= sweetbot.settings.a.afkLimit * 60000) {
            if (index[2].language === 'pt') API.sendChat('@' + index[2].username + '  VocÃƒÂª estava ' + Math.round((now - sweetbot.userData[index[2].id].afk.time) / 60000) + '  Minutos apÃƒÂ³s o limite de tempo AFK (' + sweetbot.settings.a.afkLimit + 'm) | Esteja ativo no chat a cada ' + sweetbot.settings.a.afkLimit + ' Minutos enquanto estiver na lista de espera!');
            else API.sendChat('@' + index[2].username + ' You were ' + Math.round((now - sweetbot.userData[index[2].id].afk.time) / 60000) + ' minutes past AFK limit (' + sweetbot.settings.a.afkLimit + 'm) | Chat every ' + sweetbot.settings.a.afkLimit + ' minutes while in the waitlist.');
            API.moderateRemoveDJ(index[2].id);
            ++sweetbot.stats.afk;
        };
    },
    forceWoot: function () {
        var waitList = API.getWaitList(), index = {15: waitList[14], 10: waitList[9]};
        if (waitList.length >= 15 && sweetbot.userData[index[15].id].lastWoot > 3 && !sweetbot.userData[index[15].id].warns.forceWoot) {
            if (index[15].language === 'pt') API.sendChat('@' + index[15].username + ' Por favor, vote enquanto estiver na lista de espera, caso o contrário, voce será¡ removido em 5 músicas!');
            else API.sendChat('@' + index[15].username + ' Please woot while in the waitlist, otherwise you will be removed in 5 songs!');
            sweetbot.userData[index[15].id].warns.forceWoot = true;
        }
        if (waitList.length >= 10 && sweetbot.userData[index[10].id].warns.forceWoot && sweetbot.userData[index[10].id].lastWoot > 8) {
            if (index[10].language === 'pt') API.sendChat('@' + index[10].username + ' Voce nao votou em ' + sweetbot.userData[index[10].id].lastWoot + ' Músicas, vote em quanto estiver na lista de espera na proxima vez!');
            else API.sendChat('@' + index[10].username + ' You have not wooted in ' + sweetbot.userData[index[10].id].lastWoot + ' songs, woot while in the waitlist next time!');
            API.moderateRemoveDJ(index[10].id);
            sweetbot.userData[index[10].id].warns.forceWoot = false;
        }
    },
    motdFunction: function () {
        if (this.settings.a.customMotd) this.sendMsg(this.settings.a.motd.replace(/%r/g, API.getRoomInfo('title')));
        else {
            setTimeout(function(){sweetbot.sendMsg(sweetbot.motd[sweetbot.vars.motdInd++].replace(/%r/g, API.getRoomInfo('title')))}, 1000);
            if (sweetbot.vars.motdInd >= sweetbot.motd.length) sweetbot.vars.motdInd = 0
        }
    },
    boostLottery: function () {
        var e = API.getUsers(),
         t = e.length,
         n = API.getHistory(),
         r, i;
        for (i in e) if (!sweetbot.userData[e[i].id]) sweetbot.newUser(e[i].id);
        while (t--) {
            if (e[t].id == API.getUser().id) e.splice(t, 1);
            else if (sweetbot.vars.lotWinners.indexOf(e[t].id) > -1) e.splice(t, 1);
            else if (Date.now() - sweetbot.userData[e[t].id].joinTime < 1e3 * 60 * 10) e.splice(t, 1);
            else if (Date.now() - sweetbot.userData[e[t].id].afk.time > 1e3 * 60 * 15 || !sweetbot.userData[e[t].id].chatted) e.splice(t, 1);
            else if (API.getWaitListPosition(e[t].id) < 6 || API.getDJ().id == e[t].id) e.splice(t, 1);
            else for (i = 0; i < 10; i++) {
                if (n[i].user.id == e[t].id) {
                    e.splice(t, 1);
                    break
                }
            }
        }
        t = e.length;
        r = e[Math.floor(Math.random() * t)];
        if (r) {
            sweetbot.vars.lotWinners.push(r.id);
            sweetbot.vars.lotWinner = r.id;
            sweetbot.timeouts.lotSelect = setTimeout(sweetbot.boostLottery, 1e3 * 120);
            API.sendChat("@" + r.username + ' Você ganhou a loteria! Antes de 2 minutos, digite !lottery para ser movido a posição 5. Caso o contrário, será¡ sorteado outro usuario.');
        } else sweetbot.sendMsg("Infelizmente, ninguem estava possibilitado para ganhar a loteria!( ou alguma coisa ruim aconteceu!) Será sorteado um novo ganhador, então fique ativo no chat!")
    },
    newUser: function (e) {
        this.userData[e] = {
            woots: 0,
            mehs: 0,
            vote: 0,
            afkMessage: '',
            afkCooldown: true,
            lastWoot: 0,
            warns: {
                forceWoot: false
            },
            afk: {
                time: Date.now(),
                warn1: 0,
                warn2: false
            },
            chatted: false,
            joinTime: Date.now(),
            leaveTime: null,
            lastDC: {
                pos: -1,
                song: -1,
                afk: -1
            },
            muted: false,
            inRoom: true,
            inbox: {
                msg: "",
                from: ""
            }
        }
    },
    getUserByName: function(name){
        for(var i in API.getUsers()) {
            if (API.getUsers()[i].username === name.trim()) return API.getUsers()[i].id;
        }
    },
    refreshWL: function () {
        var e = API.getWaitList(),
         t;
        this.waitList = [];
        for (t in e) this.waitList.push(e[t].id);
        if (this.waitList.length > 50) this.waitList.pop()
    },
    lockSkip: function () {
        var id = API.getDJ().id;
        clearTimeout(this.timeouts.skip);
        this.vars.skipping = true;
        if (!API.getRoomInfo('cycle')){
            $.ajax({ type: 'PUT', url: '/_/booth/cycle', dataType: 'json', contentType: 'application/json', data: JSON.stringify({'shouldCycle':true}) }).done(function(){API.moderateForceSkip();})
            API.once(API.ADVANCE, function(){
                $.ajax({ type: 'PUT', url: '/_/booth/cycle', dataType: 'json', contentType: 'application/json', data: JSON.stringify({'shouldCycle':false}) }); 
                API.moderateMoveDJ(id, 1)})
        } else {
            API.once(API.ADVANCE, function(){API.moderateMoveDJ(id, 1)});
            API.moderateForceSkip();
        }
        this.vars.skipping = false;
    },
/*     lockSkip: function () {
        this.vars.lockSkipping = true;
        clearTimeout(this.timeouts.skip);
        var id = API.getDJ().id;
        this.vars.skipping = true;
        this.vars.cycleWasFalse = false;
        if (!this.getCycle()){
            data = {service: 'room.cycle_booth',body: [location.pathname.replace(/\//g, ''), true]};
            $.ajax({ type: 'POST', url: 'http://plug.dj/_/gateway/room.cycle_booth', contentType: 'application/json', data: JSON.stringify(data) })
            this.vars.cycleWasFalse = true;
        }
        setTimeout(function(){API.moderateForceSkip()}, 500);
        if (this.vars.cycleWasFalse){
            data = {service: 'room.cycle_booth',body: [location.pathname.replace(/\//g, ''), false]};
            setTimeout(function(){$.ajax({ type: 'POST', url: 'http://plug.dj/_/gateway/room.cycle_booth', contentType: 'application/json', data: JSON.stringify(data) })}, 1500)
        }
        setTimeout(function(){API.moderateMoveDJ(id, 1)}, 200);
        this.vars.skipping = false;
    }, 
*/
    saveData: function () {
        var e = {
            arrays: this.arrays,
            stats: this.stats,
            users: this.userData,
            b: Date.now()
        },
         t = {
            settings: this.settings.a
         };
        localStorage.setItem("sweetbotData", JSON.stringify(e));
        localStorage.setItem("sweetbotSettings", JSON.stringify(t));
        console.log("Saved Sweet Chat Bot data.")
    },
    getTime: function (e) {
        e = Math.floor(e / 6e4);
        var t = e - Math.floor(e / 60) * 60;
        var n = (e - t) / 60;
        var r = "";
        r += n < 10 ? "0" : "";
        r += n + "h";
        r += t < 10 ? "0" : "";
        r += t;
        return r
    },
    getLocked: function () {
        return this.ctx.wl.attributes.isLocked;
    },
    getCycle: function () {
        return this.ctx.wl.attributes.shouldCycle;
    },
    addUsers: function () {
        var e = API.getWaitList(),
         t = this.addToWL.length,
         n, r, i = true,
         s;
        if (t) {
            while (t--) {
                for (s in e) {
                    if (this.addToWL[t].id == e[s].id) {
                        this.addToWL.splice(t, 1);
                        break
                    }
                }
            }
            if (!this.addToWL.length) API.moderateLockWaitList(false);
            else if (e.length < 50) {
                n = this.addToWL[0].id, r = this.addToWL[0].pos;
                if (API.getUser().id != n) API.moderateAddDJ(n);
                else {
                    API.djJoin();
                    this.sendMsg("joined the waitlist")
                }
                setTimeout(function () {
                    API.moderateMoveDJ(n, r)
                }, 4e3)
            }
        }
    },
    getMehs: function () {
        var e = API.getUsers();
        var mehs = [];
        for (var t in e) if (e[t].vote == -1) mehs.push(e[t].username);
        API.chatLog(mehs.join(' | '), true);
    },
    resetDC: function (e) {
        this.userData[e].lastDC.pos = -1;
        this.userData[e].lastDC.song = -1;
        this.userData[e].lastDC.afk = -1
    },
    stringFix: function (e) {
        e = e.replace(/&#39;/g, "'");
        e = e.replace(/&#34;/g, '"');
        e = e.replace(/&/g, "&");
        e = e.replace(/&lt;/g, "<");
        e = e.replace(/&gt;/g, ">");
        return e
    },
    sendMsg: function (e) {
        API.sendChat("/me " + e)
    },
    getModules : function(){
        var def = require.s.contexts._.defined,
            k = Object.keys(def);
         
        for (var j in k){
            if (!def[k[j]] || typeof def[k[j]] == 'function' || !Object.keys(def[k[j]]).length || (Object.keys(def[k[j]]).length <= 3 && !def[k[j]].length && !def[k[j]].emojify))
                continue;
 
            var obj = def[k[j]];
            if ( obj.attributes && obj.attributes.waitingDJs != null ){
                this.ctx.wl = obj;
                continue;
            }
            if ( obj.attributes && obj.attributes.joinTime != null ){
                this.ctx.room = obj;
                continue;
            }
        }
    },
    motd: ["Tenha certeza que a música que você vai tocar não tenha sido tocada! (Você pode checar no historico de músicas tocadas)", "  Participe do nosso grupo no facebook! https://www.facebook.com/groups/ETD.plug/", " Use o comando !op para checar a lista de músicas OP (Overplayed) e !blacklist a lista de músicas banidas ", " Sejam Bem vindos a Songs We Like, Ajude os novos usuarios e divirta-se! <3 ", "Se você desconectou-se e perdeu o seu lugar na fila, você pode usar o comando !dc para ser adicionado a sua antiga posição.", 'Se você estiver com lag, tente digitar /cap 1 no chat, reduz o nûmero de avatares para 1. /cap 200 Faz voltar ao normal.', " Esteja ativo no chat para ter a chance de ganhar a posição 5  na loteria! ", " Removemos usuarios que não votam na lista de espera, por favor, vote ou use um autowoot.We remove djs that don't woot in the waitlist !", " Use o comando !eta para saber o tempo aproximado a chegar sua vez de ser o DJ! ", "Se você tem alguma duvida, não tenha vergonha de perguntar a staff ! estamos aqui para ajuda-lo! :P ", 'Não sabe como votar e entrar na fila automaticamente ? cheque esse tutorial!', 'Usuarios agora possuem comandos! use !commands  para checa-los.'],
    arrays: {
        ruleSkip: {},
        links: ["https://plug.dj/terms", "https://plug.dj/privacy", "https://plug.dj/about", "https://blog.plug.dj", "https://support.plug.dj"],
        blacklist: ["1:wsUQKw4ByVg", "1:1JeLoOhnlTk","1:Qksg5y1E4xI", "1:hO3EIkjvQE0", "1:Coeey7tgOAA", "1:9Olgs-T6xXU", "1:84UbHtJEpqM", "1:cW1uFiuHtgw", "1:tZy4f7BBxFg", "1:F3CsHNLJiXs", "1:bQs8ADFMWLQ", "1:HkFk9pLo6Ek", "1:uoRyUDOIb6A", "1:82lTEQuIoFY", "1:YBqCbVKqzGU", "1:VwwTHf-ef8o", "1:IJ-l0YQWf1c", "1:FhQjrc75TlY", "1:hM7BvgJ2JRY", "1:6Y5VWf4Wixc", "1:a7PHskJqa5Q", "1:6lcRkh4bZDs", "1:2UH1DH2fm9U", "1:99zKqXEc80s", "1:jofNR_WkoCE", "1:4xS3TIa2gSQ", "1:F-KosaNKrks", "1:j-CVp6_gCbQ", "1:PGildABlXBM", "1:p2Vrtu44tyA", "1:O3WAt_jw_wg", "1:UWD0WEOPkgs", "1:sChGNMATNu8", "1:_8lSKVcFY3o", "1:PdNwHtCIyX4"],
        spam: ["caralho", "pÃƒÂªnis", "penis", "HU3HU3HU3HU3HU3HU3", "fuck", "BR BR BR BR", "KUA KUA BR BR", "vsf", "buceta", "HU3HU3HU3HU3HU3HU3", "porchmonkeyhttp://goo.gl/mIQnO0", "BR BR BR BR", "pussy", "filho da puta", "cocksucker", "asshole", "vagina", "tit", "mangina", "tits", "cock", "jerk", "sexo anal", "asfalto", "nego drama", "vtc", "macaco", "BRBR", "BR BR", "puta", "HUEHUEHUEHUE"],
        off: ["nigger", "niggger", "spick", "porchmonkey", "Filho da puta", "towelhead", "Arrombado", "porch monkey"],
        cookie: ["Está¡ achando que você está¡ desprotegido e te deu um pacote Baidu gratis!!","Acha que você está muito estressado fera! tome aqui um calmante!!","Te deu  um copo d'água para você fazer inveja nos paulistas!"," Pediu pra você dar like na foto de perfil dele !","Te deu uma vara de pescar, tome e vá arranjar o que comer !","Te deu um belo tijolo pintado de ouro! Parabéns !","Te deu um biscoito da sorte! nele estava¡ escrito \"por qual motivo você está¡ perdendo seu tempo lendo isso\" ! "," Marcou você e mais 44 pessoas em  um post!", "  Acabou de te fazer um dom dom dom :trollface:"],
        questions: ["Opção desativada no momento!"]
    }
};
stripLink = function(data){
       var div = document.createElement('DIV');
       div.innerHTML = data;
        return div.textContent || div.innerText || "";
}
//Array.prototype.rm=function(){var c,f=arguments,d=f.length,e;while(d&&this.length){c=f[--d];while((e=this.indexOf(c))!==-1){this.splice(e,1)}}return this};
String.prototype.startsWith=function(b){return "string" !== typeof b || b.length > this.length ? false : this.indexOf(b) === 0}; 
_.extend(sweetbot, Backbone.Events);
$('head').append($('<audio />', {id: 'jump', src: 'https://derpthebass.com/_/jump.mp3'})); API.on(API.CHAT, function(_){ _.type === 'mention' && document.getElementById('jump').play(); })
sweetbot.startup()